<!doctype html>
<html class="no-js" lang="vi">
<meta http-equiv="content-type" content="text/html;charset=utf-8" />

<head>
    <!-- Basic page needs ================================================== -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta property="og:locale" content="vi_VN">
    <link rel="alternate" hreflang="x-default" href="../index.html">
    <link rel="alternate" hreflang="vi" href="../index.html">
    <meta name="revisit" content="1 days">
    <meta name="robots" content="index,follow">
    <!-- Meta Pixel Code -->
    <script>
        !function (f, b, e, v, n, t, s) {
            if (f.fbq) return; n = f.fbq = function () {
                n.callMethod ?
                    n.callMethod.apply(n, arguments) : n.queue.push(arguments)
            };
            if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
            n.queue = []; t = b.createElement(e); t.async = !0;
            t.src = v; s = b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t, s)
        }(window, document, 'script',
            'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '1183122993099354');
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
            src="https://www.facebook.com/tr?id=1183122993099354&ev=PageView&noscript=1" /></noscript>
    <!-- End Meta Pixel Code -->
    <link rel="shortcut icon" href="../../theme.hstatic.net/1000313040/1000406925/14/faviconee64.png"
        type="image/png" />

    <!-- Title and description ================================================== -->
    <title>
        Bánh Mì Chảo Thương Nhớ
    </title>
    <meta property="og:type" content="website">
    <meta property="og:title" content="Bánh Mì Chảo Thương Nhớ">
    <!-- Meta Pixel Code -->
    <script>
        !function (f, b, e, v, n, t, s) {
            if (f.fbq) return; n = f.fbq = function () {
                n.callMethod ?
                    n.callMethod.apply(n, arguments) : n.queue.push(arguments)
            };
            if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
            n.queue = []; t = b.createElement(e); t.async = !0;
            t.src = v; s = b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t, s)
        }(window, document, 'script',
            'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '694234706407697');
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
            src="https://www.facebook.com/tr?id=694234706407697&ev=PageView&noscript=1" /></noscript>
    <!-- End Meta Pixel Code -->
    <meta property="og:url" content="https://banhmichaothuongnho.com">
    <meta property="og:site_name" content="Bánh Mì Chảo Thương Nhớ">

    <meta name="twitter:site" content="@https://">
    <meta name="twitter:card" content="summary">

    <link rel="canonical" href="../index.html">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <meta name="theme-color" content="#3d1a1a">
    <!-- CSS ================================================== -->
    <link href='../../theme.hstatic.net/1000313040/1000406925/14/timber.scssee64.css' rel='stylesheet' type='text/css'
        media='all' />
    <link href='../../theme.hstatic.net/1000313040/1000406925/14/check_outee64.css' rel='stylesheet' type='text/css'
        media='all' />
    <link href='../../theme.hstatic.net/1000313040/1000406925/14/style-cafesuplo.scssee64.css' rel='stylesheet'
        type='text/css' media='all' />
    <link href='../../theme.hstatic.net/1000313040/1000406925/14/owl.carouselee64.css' rel='stylesheet' type='text/css'
        media='all' />
    <link href='../../theme.hstatic.net/1000313040/1000406925/14/owl.themeee64.css' rel='stylesheet' type='text/css'
        media='all' />
    <link href='../../theme.hstatic.net/1000313040/1000406925/14/owl.transitionsee64.css' rel='stylesheet'
        type='text/css' media='all' />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
        integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <meta name="google-site-verification" content="1YCTpCogncSDl7UJaoD_Dgu3MOaGZ_p1SDwiMCKqT1Y" />

    <script src='../../ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js' type='text/javascript'></script>
    <script src='../../theme.hstatic.net/1000313040/1000406925/14/modernizr.minee64.js' type='text/javascript'></script>
    <script src='../../theme.hstatic.net/1000313040/1000406925/14/owl.carousel.minee64.js'
        type='text/javascript'></script>

</head>

<body id="banhmichao" class="template-collection">



    <div id="NavDrawer" class="drawer drawer--left">
        <div class="drawer__header">
            <div class="drawer__title h3"><img src="../../theme.hstatic.net/1000313040/1000406925/14/logoee64.png"
                    alt="Bánh Mì Chảo Thương Nhớ" /></div>
            <div class="drawer__close js-drawer-close">
                <button type="button" class="icon-fallback-text">
                    <span class="icon icon-x" aria-hidden="true"></span>
                    <span class="fallback-text">Đóng</span>
                </button>
            </div>
        </div>
        <!-- begin mobile-nav -->
        <ul class="mobile-nav">
            <li class="mobile-nav__item mobile-nav__search">
                <form action="../collections/search.html" method="get" class="input-group search-bar home-search-bar"
                    role="search">
                    <input type="hidden" name="type" value="product">
                    <input type="search" name="q" value="" placeholder="Tìm kiếm..." class="input-group-field"
                        aria-label="Tìm kiếm...">
                    <span class="input-group-btn">
                        <button type="submit" class="btn icon-fallback-text">
                            <span class="icon icon-search" aria-hidden="true"></span>
                            <span class="fallback-text">Tìm kiếm</span>
                        </button>
                    </span>
                </form>

            </li>

        </ul>
        <!-- //mobile-nav -->
    </div>


    <div id="CartDrawer" class="drawer drawer--right">
        <div class="drawer__header">
            <div class="drawer__title h3">Giỏ hàng</div>
            <div class="drawer__close js-drawer-close">
                <button type="button" class="icon-fallback-text">
                    <span class="icon icon-x" aria-hidden="true"></span>
                    <span class="fallback-text">"Đóng"</span>
                </button>
            </div>
        </div>
        <div id="CartContainer"></div>
    </div>
    <div class="cart-overlay"></div>


    <header class="medium-down--hide">
        <div id="site-header" class="medium-down--hide ">
            <div class="wrapper">
                <div class="inner">
                    <div class="grid mg-left-15">
                        <div class="grid__item large--one-twelfth pd-left0">
                            <div class="hd-logo">



                                <a href="../index.html">
                                    <img class="avata"
                                        src="../../theme.hstatic.net/1000313040/1000406925/14/logoee64.png"
                                        alt="Bánh Mì Chảo Thương Nhớ" />
                                </a>


                            </div>
                        </div>
                        <div class="grid__item large--three-twelfths pd-left15 hd-searchbar">
                            <form action="../collections/search.html" method="get"
                                class="input-group search-bar home-search-bar" role="search">
                                <input type="hidden" name="type" value="product">
                                <input type="search" name="q" value="" placeholder="Tìm kiếm..."
                                    class="input-group-field" aria-label="Tìm kiếm...">
                                <span class="input-group-btn">
                                    <button type="submit" class="btn icon-fallback-text">
                                        <span class="icon icon-search" aria-hidden="true"></span>
                                        <span class="fallback-text">Tìm kiếm</span>
                                    </button>
                                </span>
                            </form>
                        </div>
                        <div class="grid__item large--eight-twelfths pd-left15">
                            <div class="fix-hd">
                                <a href="tel:093 1387 046">
                                    <i class="fa fa-phone" aria-hidden="true"></i>
                                    <span>093 1387 046</span>
                                </a>
                                <a href="../pages/he-thong-cua-hang.html">
                                    <i class="fa fa-building" aria-hidden="true"></i>
                                    <span>Hệ thống <b>5</b> cửa hàng</span>
                                </a>
                                <a href="../cart.html">
                                    <div class="cart-total-price">
                                        <i class="fa fa-shopping-bag" aria-hidden="true"></i>
                                        <span id="CartCount">0</span>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="grid mg-left-15">
                        <div class="grid__item large--one-whole pd-left0">
                            <div id="topmenu">
                                <div class="wrapper">
                                    <div class="inner">
                                        <div class="grid mg-left-15">
                                            <div class="grid__item large--one-whole pd-left15">
                                                <div class="hd-navbar">
                                                    <ul class="no-bullets" id="menu-container">
                                                        <!-- Menu sẽ được tạo động từ dữ liệu JSON -->
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- tạo danh mục menu -->
    <script>
        function normalizeImagePath(path) {
            if (path.startsWith('../')) {
                return path;
            } else if (path.startsWith('./')) {
                return '../' + path.substring(2);
            } else {
                return '../' + path;
            }
        }
    </script>
    <script>
        function createMenu(menuData) {
            const menuContainer = document.getElementById('menu-container');

            // Xóa nội dung cũ nếu có
            menuContainer.innerHTML = '';

            // Tạo menu từ dữ liệu
            menuData.categories.forEach(category => {
                // Tạo phần tử li cho mỗi danh mục
                const categoryLi = document.createElement('li');
                categoryLi.className = 'dropdown';

                // Tạo liên kết cho danh mục
                const categoryLink = document.createElement('a');
                categoryLink.href = normalizeImagePath(category.url);
                categoryLink.innerHTML = `${category.name} <i class="fa fa-angle-down" aria-hidden="true"></i>`;
                categoryLi.appendChild(categoryLink);

                // Tạo submenu cho sản phẩm
                if (category.products && category.products.length > 0) {
                    const submenu = document.createElement('ul');
                    submenu.className = 'no-bullets dropdown-menu';

                    // Thêm các sản phẩm vào submenu
                    category.products.forEach(product => {
                        const productLi = document.createElement('li');
                        const productLink = document.createElement('a');
                        productLink.href = normalizeImagePath(product.url);
                        productLink.textContent = product.name;
                        productLi.appendChild(productLink);
                        submenu.appendChild(productLi);
                    });

                    categoryLi.appendChild(submenu);
                }

                // Thêm danh mục vào menu chính
                menuContainer.appendChild(categoryLi);
            });
        }

        // Hàm để tải dữ liệu JSON từ tệp
        function loadMenuData() {
            fetch(normalizeImagePath('products/getData.php?file=menu-data'))  // Tên tệp JSON của bạn
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Không thể tải dữ liệu menu');
                    }
                    return response.json();
                })
                .then(data => {
                    createMenu(data);
                })
                .catch(error => {
                    console.error('Lỗi khi tải dữ liệu menu:', error);
                });
        }

        // Tải menu khi trang được tải
        document.addEventListener('DOMContentLoaded', loadMenuData);
    </script>

    <script>

        // Hàm để tải menu từ file JSON
        function loadMenuFromJSON() {
            fetch(normalizeImagePath('products/getData.php?file=menu-data'))  // Giả định là bạn đã lưu file JSON với tên này
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    renderMenu(data);
                })
                .catch(error => {
                    console.error('Có lỗi khi tải dữ liệu menu:', error);
                });
        }

        // Hàm để render menu từ dữ liệu JSON
        function renderMenu(data) {
            const navDrawer = document.getElementById('NavDrawer');
            const mobileNav = document.createElement('ul');
            mobileNav.className = 'mobile-nav';

            // Tạo phần tìm kiếm
            const searchItem = document.createElement('li');
            searchItem.className = 'mobile-nav__item mobile-nav__search';
            searchItem.innerHTML = `
<form action="../collections/search.html" method="get" class="input-group search-bar home-search-bar" role="search">
<input type="hidden" name="type" value="product">
<input type="search" name="q" value="" placeholder="Tìm kiếm..." class="input-group-field" aria-label="Tìm kiếm...">
<span class="input-group-btn">
<button type="submit" class="btn icon-fallback-text">
<span class="icon icon-search" aria-hidden="true"></span>
<span class="fallback-text">Tìm kiếm</span>
</button>
</span>
</form>
`;
            mobileNav.appendChild(searchItem);

            // Thêm các mục menu từ dữ liệu JSON
            data.categories.forEach(category => {
                const categoryItem = document.createElement('li');

                if (category.products && category.products.length > 0) {
                    // Danh mục có các sản phẩm con
                    categoryItem.className = 'mobile-nav__item';
                    categoryItem.setAttribute('aria-haspopup', 'true');

                    categoryItem.innerHTML = `
<div class="mobile-nav__has-sublist">
<a href="${normalizeImagePath(category.url)}" class="mobile-nav__link">${category.name}</a>
<div class="mobile-nav__toggle">
<button type="button" class="icon-fallback-text mobile-nav__toggle-open">
  <span class="icon icon-plus" aria-hidden="true"></span>
  <span class="fallback-text">See More</span>
</button>
<button type="button" class="icon-fallback-text mobile-nav__toggle-close">
  <span class="icon icon-minus" aria-hidden="true"></span>
  <span class="fallback-text">"Đóng"</span>
</button>
</div>
</div>
<ul class="mobile-nav__sublist">
${category.products.map(product => `
<li class="mobile-nav__item" aria-haspopup="true">
  <div class="mobile-nav__has-sublist">
	<a href="${normalizeImagePath(product.url)}" class="mobile-nav__link">${product.name}</a>
  </div>
</li>
`).join('')}
</ul>
`;
                } else {
                    // Danh mục không có sản phẩm con
                    categoryItem.className = 'mobile-nav__item';
                    categoryItem.innerHTML = `
<a href="${normalizeImagePath(category.url)}" class="mobile-nav__link">${category.name}</a>
`;
                }

                mobileNav.appendChild(categoryItem);
            });

            // Xóa menu cũ và thêm menu mới
            const oldMobileNav = navDrawer.querySelector('.mobile-nav');
            if (oldMobileNav) {
                navDrawer.removeChild(oldMobileNav);
            }
            navDrawer.appendChild(mobileNav);

            // Thêm event listeners cho các nút toggle
            addToggleListeners();
        }

        // Hàm để thêm event listeners cho các nút toggle - ĐÃ SỬA LẠI
        function addToggleListeners() {
            const toggleButtons = document.querySelectorAll('.mobile-nav__toggle');

            toggleButtons.forEach(button => {
                button.addEventListener('click', function () {
                    // Lấy phần tử cha .mobile-nav__has-sublist
                    const hasSublist = this.closest('.mobile-nav__has-sublist');
                    const openButton = this.querySelector('.mobile-nav__toggle-open');
                    const closeButton = this.querySelector('.mobile-nav__toggle-close');

                    // Toggle class mobile-nav--expanded cho hasSublist
                    if (hasSublist.classList.contains('mobile-nav--expanded')) {
                        hasSublist.classList.remove('mobile-nav--expanded');
                        openButton.style.display = 'inline-block';
                        closeButton.style.display = 'none';
                    } else {
                        hasSublist.classList.add('mobile-nav--expanded');
                        openButton.style.display = 'none';
                        closeButton.style.display = 'inline-block';
                    }
                });
            });
        }

        // Tải menu khi trang đã tải xong
        document.addEventListener('DOMContentLoaded', loadMenuFromJSON);
    </script>

    <script>
        // Script để lấy dữ liệu danh mục menu từ file JSON
        document.addEventListener('DOMContentLoaded', function () {
            // Đường dẫn đến file JSON của bạn
            const jsonFilePath = normalizeImagePath('products/getData.php?file=menu-data');

            // Hàm để tải dữ liệu từ file JSON
            function loadMenuData() {
                fetch(jsonFilePath)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Không thể tải file JSON. Trạng thái: ' + response.status);
                        }
                        return response.json();
                    })
                    .then(data => {
                        renderMenu(data.categories);
                        // Khôi phục lại sự kiện click sau khi đã render menu
                        setupDropMenuEvent();
                    })
                    .catch(error => {
                        console.error('Lỗi khi tải dữ liệu menu:', error);
                    });
            }

            // Hàm thiết lập sự kiện cho nút drop-menu
            function setupDropMenuEvent() {
                // Đảm bảo chỉ gắn sự kiện một lần
                $('#drop-menu').off('click').on('click', function () {
                    $('#nav-mobile').toggleClass('red_highlight', 'no_highlight');
                });
            }

            // Hàm render menu dựa trên cấu trúc HTML hiện tại
            function renderMenu(categories) {
                const navMobile = document.getElementById('nav-mobile');
                if (!navMobile) return;

                // Lưu trạng thái class hiện tại
                const hasRedHighlight = navMobile.classList.contains('red_highlight');

                navMobile.innerHTML = ''; // Xóa menu cũ

                // Khôi phục class red_highlight nếu có
                if (hasRedHighlight) {
                    navMobile.classList.add('red_highlight');
                }

                categories.forEach(category => {
                    const li = document.createElement('li');
                    li.className = '';

                    const a = document.createElement('a');
                    a.href = normalizeImagePath(category.url);
                    a.textContent = category.name;

                    li.appendChild(a);
                    navMobile.appendChild(li);
                });
            }

            // Gọi hàm tải dữ liệu
            loadMenuData();
        });
    </script>

    <header class="fixd-mobile large--hide">

        <div id="site-mobile" class="large--hide ">
            <div class="wrapper">
                <div class="inner">
                    <div class="grid">
                        <div class="grid__item medium--two-twelfths small--two-twelfths">
                            <div class="site-nav--mobile">
                                <button type="button" class="icon-fallback-text site-nav__link js-drawer-open-left"
                                    aria-controls="NavDrawer" aria-expanded="false">
                                    <i class="fa fa-bars" aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>
                        <div class="grid__item medium--eight-twelfths small--eight-twelfths pd-left0 hd-searchbar">
                            <form action="../collections/search.html" method="get"
                                class="input-group search-bar home-search-bar" role="search">
                                <input type="hidden" name="type" value="product">
                                <input type="search" name="q" value="" placeholder="Tìm kiếm..."
                                    class="input-group-field" aria-label="Tìm kiếm...">
                                <span class="input-group-btn">
                                    <button type="submit" class="btn icon-fallback-text">
                                        <span class="icon icon-search" aria-hidden="true"></span>
                                        <span class="fallback-text">Tìm kiếm</span>
                                    </button>
                                </span>
                            </form>

                        </div>
                        <div class="grid__item medium--two-twelfths small--two-twelfths text-right">
                            <div class="site-nav--mobile cart-site">
                                <a href="../cart.html" class="js-drawer-open-right site-nav__link text-center"
                                    aria-controls="CartDrawer" aria-expanded="false">
                                    <span class="icon-fallback-text">
                                        <i class="fa fa-shopping-cart" aria-hidden="true"></i>
                                    </span>
                                </a>
                            </div>
                        </div>
                        <div class="grid__item medium--one-whole small--one-whole">
                            <div class="fix-hd">
                                <a href="tel:093 1387 046">
                                    <i class="fa fa-phone" aria-hidden="true"></i>
                                    <span>093 1387 046</span>
                                </a>
                                <a href="../pages/he-thong-cua-hang.html">
                                    <i class="fa fa-building" aria-hidden="true"></i>
                                    <span>Hệ thống <b>5</b> cửa hàng</span>
                                </a>

                            </div>
                        </div>
                        <div class="grid__item medium--one-whole small--one-whole pd-left0">
                            <div id="site-header">
                                <div id="topmenu">
                                    <div class="hd-navbar">
                                        <ul id="nav-mobile" class="no-bullets">

                                        </ul>
                                        <span id="drop-menu" class="icon-drop">
                                            <i class="fa fa-angle-double-down"></i>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <script>
                                $(document).ready(function () {

                                    $('#drop-menu').on('click', function () {
                                        $('#nav-mobile').toggleClass('red_highlight', 'no_highlight');
                                    });
                                });

                            </script>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>




    <div id="home-main-slider" class="owl-carousel">



        <div class="owl-slide owl-slide2">
            <a href="#"><img src="../../theme.hstatic.net/1000313040/1000406925/14/ms_banner_img2ee64.jpg"
                    class="img-responsive" /></a>


        </div>


        <div class="owl-slide owl-slide3">
            <a href="#"><img src="../../theme.hstatic.net/1000313040/1000406925/14/ms_banner_img3ee64.jpg"
                    class="img-responsive" /></a>


        </div>


        <div class="owl-slide owl-slide4">
            <a href="#"><img src="../../theme.hstatic.net/1000313040/1000406925/14/ms_banner_img4ee64.jpg"
                    class="img-responsive" /></a>


            <div id="owl-slide-content-wrapper4">
                <div class="grid">
                    <div class="grid__item large--one-half">
                        <div class="slide-content">
                            <div class="slide-light-text clearfix">

                            </div>
                            <div class="slide-bold-text clearfix">

                            </div>
                            <div class="slide-btn">

                                <a href="banh-my-banh-man.html" class="slide-btn1">xem thêm</a>


                                <a href="#" class="slide-btn2"></a>

                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>




        <div class="owl-slide owl-slide5">
            <a href="../pages/he-thong-cua-hang.html"><img
                    src="../../theme.hstatic.net/1000313040/1000406925/14/ms_banner_img5ee64.jpg"
                    class="img-responsive" /></a>


            <div id="owl-slide-content-wrapper5">
                <div class="grid">
                    <div class="grid__item large--one-half">
                        <div class="slide-content">
                            <div class="slide-light-text clearfix">

                            </div>
                            <div class="slide-bold-text clearfix">

                            </div>
                            <div class="slide-btn">

                                <a href="../pages/he-thong-cua-hang.html" class="slide-btn1">xem thêm</a>


                                <a href="#" class="slide-btn2"></a>

                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>



    </div>

    <div id="home-main-slidermb" class="owl-carousel slider-mobile">



        <div class="owl-slide owl-slide2">
            <a href="#">
                <img src="../../theme.hstatic.net/1000313040/1000406925/14/mb_banner_img2ee64.jpg"
                    class="img-responsive" />
            </a>
        </div>



        <div class="owl-slide owl-slide3">
            <a href="#">
                <img src="../../theme.hstatic.net/1000313040/1000406925/14/mb_banner_img3ee64.jpg"
                    class="img-responsive" />
            </a>
        </div>


        <div class="owl-slide owl-slide4">
            <a href="#">
                <img src="../../theme.hstatic.net/1000313040/1000406925/14/mb_banner_img4ee64.jpg"
                    class="img-responsive" />
            </a>
        </div>


        <div class="owl-slide owl-slide5">
            <a href="blogs/news/anh-hoa-bakery-khai-truong-co-so-12-tai-so-275-ho-tung-mau.html">
                <img src="../../theme.hstatic.net/1000313040/1000406925/14/mb_banner_img5ee64.jpg"
                    class="img-responsive" />
            </a>
        </div>




    </div>



    <section id="breadcrumb-wrapper" class="breadcrumb-w-img">
        <div class="breadcrumb-overlay"></div>
        <div class="breadcrumb-content">
            <div class="wrapper">
                <div class="inner text-center">
                    <div class="breadcrumb-big">

                        <h2>
                            Bánh Mì Chảo Thương Nhớ
                        </h2>
                    </div>

                </div>
            </div>
        </div>
    </section>

    <div id="PageContainer" class="is-moved-by-drawer">
        <main class="main-content" role="main">
            <div class="product-main-content">
                <div class="wrapper">
                    <div class="inner">
                        <div itemscope itemtype="http://schema.org/Product">
                            <div class="grid">
                                <div class="grid__item large--four-twelfths text-center">
                                    <div class="product-single__photos">
                                        <div id="ProductPhoto" class="owl-carousel owl-enable" data-slide="1"
                                            data-pagination="false" data-nav="true">
                                            <li>
                                                <a class="image-resize">
                                                    <img src="../../theme.hstatic.net/1000313040/1000406925/14/logobmc_big.png"
                                                        alt="Bánh Mì Chảo Thương Nhớ" />
                                                </a>
                                            </li>
                                        </div>
                                    </div>

                                    <ul class="product-single__thumbnails inline-list" id="ProductThumbs"
                                        data-nav="false">
                                        <div class="inner">

                                            <div class="owldemo4-wrapper ">
                                                <div id="owl-demo4" class="owl-carousel owl-enable boxi-owl"
                                                    data-items="4" data-pagination="false" data-desktop="[1240, 3]"
                                                    data-mobile="[768, 3]">

                                                    <li class="thumbnail-item item">
                                                        <a href="../../theme.hstatic.net/1000313040/1000406925/14/logobmc_big.png"
                                                            class=" thumbnail-resize product-single__thumbnail"
                                                            data-pos="0">
                                                            <img src="../../theme.hstatic.net/1000313040/1000406925/14/logobmc_big.png"
                                                                alt="Bánh Mì Chảo Thương Nhớ">
                                                        </a>
                                                    </li>

                                                </div>
                                            </div>
                                        </div>
                                    </ul>

                                </div>

                                <div class="grid__item large--eight-twelfths product-page">
                                    <div class="product--page-content">
                                        <h1 itemprop="name">Bánh Mì Chảo Thương Nhớ</h1>
                                        <p class="product-more-info">
                                            <span class="product-sku">
                                                Mã sản phẩm: <span id="ProductSku" class="ProductSku"
                                                    itemprop="SKU">BMCTN01</span>
                                            </span>
                                        </p>
                                        <hr>
                                        <div class="product-info grid">
                                            <div class="grid__item one-whole">
                                                <p class="line-price">
                                                    <span class="">Giá</span>
                                                    <span id="ProductPrice" class="ProductPrice" itemprop="price"
                                                        content="0">0₫ </span>/
                                                </p>
                                            </div>
                                        </div>
                                        <form action="" method="post" enctype="multipart/form-data" id="AddToCartForm"
                                            class="form-vertical">
                                            <select name="id" id="productSelect" class="product-single__variants hide">
                                                <option selected="selected" data-sku="BMCTN01">39,000 VND</option>
                                            </select>
                                            <div id="product-select-watch" class="select-swatch">
                                                <div id="swatch-quick-view" class="select-swatch">
                                                    <div id="variant-swatch-0-quickview"
                                                        class="swatch swatch-quick-view clearfix" data-option="option1"
                                                        data-option-index="0">
                                                        <div class="header">Topping</div>
                                                        <div class="select-swap"></div>
                                                    </div>
                                                    <div id="variant-swatch-1-quickview"
                                                        class="swatch swatch-quick-view clearfix" data-option="option2"
                                                        data-option-index="1">
                                                        <div class="header">Đồ uống</div>
                                                        <div class="select-swap"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="product-quantity clearfix">
                                                <div class="qty-addcart clearfix">
                                                    <span>Số lượng </span>
                                                    <input type="number" id="Quantity" name="quantity" value="1" min="1"
                                                        class="quantity-selector"
                                                        onkeypress="return event.charCode >= 48 && event.charCode <= 57">
                                                </div>
                                            </div>
                                            <div class="product-actions">
                                                <button type="submit" name="add" id="AddToCart"
                                                    class="btnAddtocart">Thêm vào giỏ hàng</button>
                                            </div>
                                        </form>
                                        <div id="product-single-details" itemprop="offers" itemscope
                                            itemtype="http://schema.org/Offer">
                                            <meta itemprop="priceCurrency" content="VND">
                                            <link itemprop="availability" href="http://schema.org/InStock">
                                        </div>
                                    </div>
                                </div>


                            </div>

                            <div class="content2">
                                <div class="product-tabs">
                                    <div class="tab">
                                        <button class="tablinks" onclick="openTab(event, 'product-long-description')"
                                            id="defaultOpen">
                                            Mô tả chung
                                        </button>
                                        <button class="tablinks" onclick="openTab(event, 'product-comments')">Bình
                                            luận</button>
                                    </div>
                                    <div class="content-product-tab">
                                        <div id="product-long-description" class="tabcontent" itemprop="description">

                                            Giòn, Thơm, Đậm Đà - Cảm Nhận Hương Vị Nhà!!!

                                        </div>
                                        <div id="product-comments" class="tabcontent">
                                            <div class="fb-comments" data-width="100%"
                                                data-href="tiramisu-cake-mousse-3.html"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <section id="related-products">
                <div class="wrapper">
                    <div class="inner">
                        <div class="home-section-head text-center title-text clearfix">
                            <h3>Có thể bạn thích</h3>
                            <h2>Món Ngon Khác của chúng tôi</h2>
                            <img src="../../theme.hstatic.net/1000313040/1000406925/14/product_details_lineee64.png"
                                alt="">
                        </div>
                        <div class="home-section-body">
                            <div class="custom-carousel-container">
                                <button class="custom-carousel-nav custom-prev">
                                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                                </button>

                                <div class="custom-carousel-wrapper">
                                    <div id="custom-products-slider" class="custom-carousel-track">
                                        <!-- Sản phẩm sẽ được thêm vào đây bằng JavaScript -->
                                    </div>
                                </div>

                                <button class="custom-carousel-nav custom-next">
                                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </main>
    </div>



    <!-- JavaScript cho carousel tùy chỉnh -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Các biến cho carousel
            let currentIndex = 0;
            let itemsPerPage = 3;
            let totalItems = 0;
            const track = document.getElementById('custom-products-slider');
            const nextButton = document.querySelector('.custom-next');
            const prevButton = document.querySelector('.custom-prev');

            // Điều chỉnh số lượng sản phẩm hiển thị theo kích thước màn hình
            function updateItemsPerPage() {
                if (window.innerWidth <= 480) {
                    itemsPerPage = 1;
                } else if (window.innerWidth <= 768) {
                    itemsPerPage = 2;
                } else {
                    itemsPerPage = 3;
                }
                moveCarousel(currentIndex);
            }

            // Cập nhật vị trí carousel
            // Cập nhật vị trí carousel
            function moveCarousel(index) {
                if (index < 0) index = 0;

                const maxIndex = Math.max(0, totalItems - itemsPerPage);
                if (index > maxIndex) index = maxIndex;

                currentIndex = index;

                const itemWidth = track.querySelector('.custom-carousel-item')?.offsetWidth || 0;
                const gap = parseInt(getComputedStyle(track).gap) || 0; // Lấy khoảng cách giữa các sản phẩm
                if (itemWidth) {
                    const offset = currentIndex * (itemWidth + gap);
                    track.style.transform = `translateX(-${offset}px)`;
                }

                prevButton.disabled = currentIndex === 0;
                nextButton.disabled = currentIndex >= maxIndex;
            }


            // Xử lý sự kiện nút prev và next theo kích thước màn hình
            function updateNavButtonHandlers() {
                // Xóa event listeners cũ
                prevButton.removeEventListener('click', prevClickHandler);
                nextButton.removeEventListener('click', nextClickHandler);

                // Thêm event listeners mới
                prevButton.addEventListener('click', prevClickHandler);
                nextButton.addEventListener('click', nextClickHandler);
            }

            function prevClickHandler() {
                let step = (window.innerWidth <= 480) ? 1 : itemsPerPage;
                moveCarousel(Math.max(0, currentIndex - step));
            }

            function nextClickHandler() {
                let step = (window.innerWidth <= 480) ? 1 : itemsPerPage;
                moveCarousel(Math.min(totalItems - 1, currentIndex + step));
            }


            // Xử lý sự kiện nút prev
            prevButton.addEventListener('click', function () {
                moveCarousel(currentIndex - 1);
            });

            // Xử lý sự kiện nút next
            nextButton.addEventListener('click', function () {
                moveCarousel(currentIndex + 1);
            });

            // Tải dữ liệu sản phẩm
            function loadProducts() {
                fetch(normalizeImagePath('products/getData.php?file=productData'))
                    .then(response => response.json())
                    .then(data => {
                        const productsArray = Object.values(data);
                        const randomProducts = getRandomProducts(productsArray, 7);
                        displayProducts(randomProducts);
                    })
                    .catch(error => {
                        console.error("Lỗi tải dữ liệu:", error);
                        // Hiển thị sản phẩm mẫu nếu có lỗi
                        displaySampleProduct();
                    });
            }
            document.documentElement.style.setProperty('--items-per-page', itemsPerPage);

            // Lấy ngẫu nhiên các sản phẩm
            function getRandomProducts(arr, count) {
                const shuffled = [...arr].sort(() => 0.5 - Math.random());
                return shuffled.slice(0, count);
            }

            // Hiển thị sản phẩm mẫu nếu có lỗi
            function displaySampleProduct() {
                track.innerHTML = `
	<div class="custom-carousel-item">
		<div class="product--loop">
			<div class="product-img">
				<a href="#">
					<img alt="Sản phẩm mẫu" src="../../product.hstatic.net/1000313040/product/448436545_873122281525887_5804248093557273602_n_2b46ed1a4d2a465194a16d43a38bee7d_large.jpg">
				</a>
			</div>
			<div class="product-title text-center">
				<a href="#">Sản phẩm mẫu</a>
				<p></p>
			</div>
			<div class="product-price-actions clearfix">
				<div class="product-price">Liên hệ</div>
				<div class="product-actions">
					<button type="button" class="btn add-to-cart">
						<i class="fa fa-shopping-cart" aria-hidden="true"></i>
					</button>
				</div>
			</div>
		</div>
	</div>
`;
                totalItems = 1;
                updateItemsPerPage();
            }

            // Hiển thị các sản phẩm
            function displayProducts(products) {
                track.innerHTML = '';

                products.forEach(product => {
                    const productItem = document.createElement('div');
                    productItem.className = 'custom-carousel-item';
                    productItem.innerHTML = `
		<div class="product--loop">
			<div class="product-img">
				<a href="../${product.url}">
					<img alt="${product.productName}" 
						 src="../${product.image}" 
						 style="width: 200px; height: auto; object-fit: cover;">
				</a>
			</div>
			<div class="product-title text-center">
				<a href="../${product.url}">${product.productName}</a>
				<p></p>
			</div>
			<div class="product-price-actions clearfix">
				<div class="product-price">${product.productPrice}</div>
				<div class="product-actions">
					<a href="../${product.url}" class="btn btn-view-detail">
				<i class="fa fa-eye" aria-hidden="true"></i> Xem thêm
			</a>
				</div>
			</div>
		</div>
	`;
                    track.appendChild(productItem);
                });

                totalItems = products.length;
                updateItemsPerPage();
            }

            // Theo dõi sự thay đổi kích thước màn hình
            window.addEventListener('resize', updateItemsPerPage);

            // Khởi tạo carousel
            loadProducts();
        });
    </script>

    <style>
        .collection-sidebar-wrapper.stick {
            position: fixed;
            top: 0;
            z-index: 10;
            max-width: 288px;
        }
    </style>
    <!-- CSS cho carousel tùy chỉnh -->
    <style>
        .btn-view-detail {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 10px 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            text-decoration: none;
            transition: background-color 0.3s;
        }

        .btn-view-detail:hover {
            background-color: #45a049;
            color: white;
        }

        .custom-carousel-container {
            position: relative;
            width: 100%;
            display: flex;
            align-items: center;
            padding: 0 10px;
        }

        .custom-carousel-wrapper {
            width: 100%;
            overflow: hidden;
            position: relative;
        }

        .custom-carousel-track {
            display: flex;
            transition: transform 0.3s ease-in-out;
            gap: 20px;
        }

        .custom-carousel-item {
            box-sizing: border-box;
            flex: 0 0 calc(100% / var(--items-per-page) - 10px);
        }

        .custom-carousel-nav {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.8);
            border: 1px solid #ddd;
            color: #333;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .custom-carousel-nav:hover {
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .custom-prev {
            margin-right: 15px;
        }

        .custom-next {
            margin-left: 15px;
        }

        /* Sản phẩm */
        .product--loop {
            border: 1px solid #eee;
            padding: 10px;
            background-color: #fff;
            border-radius: 8px;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .product--loop:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transform: translateY(-5px);
        }

        .product-img {
            text-align: center;
            margin-bottom: 10px;
            flex-grow: 0;
        }

        .product-img img {
            max-width: 100%;
            height: auto;
            object-fit: cover;
        }

        .product-title {
            margin-bottom: 10px;
            flex-grow: 1;
        }

        .product-title a {
            color: #333;
            font-weight: 500;
            text-decoration: none;
            display: block;
            transition: color 0.3s ease;
        }

        .product-title a:hover {
            color: #f39c12;
        }

        .product-price-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-grow: 0;
        }

        .product-price {
            font-weight: bold;
            color: #e74c3c;
        }

        .btn.add-to-cart {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: #f39c12;
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .btn.add-to-cart:hover {
            background-color: #e67e22;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .custom-carousel-item {
                flex: 0 0 calc(50% - 20px);
            }
        }

        @media (max-width: 480px) {
            .custom-carousel-item {
                flex: 0 0 calc(100% - 20px);
            }
        }
    </style>

    <!-- hiển thị sản phẩm theo key -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/elevatezoom/3.0.8/jquery.elevatezoom.min.js"></script>

    <!-- cập nhật thông tin doanh nghiệp -->
    <script>
        // Hàm tải nội dung từ file txt bên ngoài
        function loadCompanyInfo() {
            fetch(normalizeImagePath('products/company-info.txt'))
                .then(response => response.text())
                .then(data => {
                    // Chuyển đổi dấu xuống dòng thành <br>
                    const formattedData = '<p>' + data.replace(/\n/g, '<br>') + '</p>';
                    document.getElementById('company-info').innerHTML = formattedData;
                })
                .catch(error => console.error('Lỗi khi tải thông tin:', error));
        }


        // Gọi hàm khi trang được tải
        document.addEventListener('DOMContentLoaded', loadCompanyInfo);
    </script>

    <!-- xử lý sản phẩm trang web  -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Kiểm tra xem jQuery và elevateZoom đã tải chưa
            if (typeof jQuery === 'undefined' || typeof jQuery.fn.elevateZoom === 'undefined') {
                console.error("jQuery hoặc elevateZoom không được tải!");
                return;
            }

            fetch(normalizeImagePath('products/getData.php?file=productData'))
                .then(response => response.json())
                .then(data => {
                    let path = window.location.pathname;
                    let fileName = path.split("/").pop().replace(".html", "");

                    if (data.hasOwnProperty(fileName)) {
                        const product = data[fileName];
                        const newImageSrc = "../" + product.image; // Đường dẫn ảnh mới

                        // Cập nhật tên sản phẩm trong breadcrumb
                        const breadcrumbTitle = document.querySelector("#breadcrumb-wrapper .breadcrumb-big h2");
                        if (breadcrumbTitle) {
                            breadcrumbTitle.textContent = product.productName;
                        } else {
                            console.error("Breadcrumb title not found!");
                        }

                        // Cập nhật ảnh chính
                        const productImage = document.querySelector("#ProductPhoto img");
                        if (productImage) {
                            productImage.src = newImageSrc;
                            productImage.setAttribute("data-zoom-image", newImageSrc);
                            productImage.alt = product.productName;
                        } else {
                            console.error("Main product image not found in #ProductPhoto!");
                        }

                        // Cập nhật thumbnail
                        const productThumbnail = document.querySelector("#ProductThumbs .product-single__thumbnail");
                        if (productThumbnail) {
                            const thumbnailImg = productThumbnail.querySelector("img");
                            if (thumbnailImg) {
                                thumbnailImg.src = newImageSrc;
                                thumbnailImg.setAttribute("data-image", newImageSrc);
                                thumbnailImg.alt = product.productName;
                                productThumbnail.setAttribute("href", newImageSrc);
                            } else {
                                console.error("Thumbnail image not found!");
                            }
                        } else {
                            console.error("Thumbnail container not found!");
                        }

                        // Cập nhật tên sản phẩm
                        const productName = document.querySelector("h1[itemprop='name']");
                        if (productName) {
                            productName.textContent = product.productName;
                        }

                        // Cập nhật SKU
                        const productSku = document.getElementById("ProductSku");
                        if (productSku) {
                            productSku.textContent = product.productSku;
                            document.querySelector('#AddToCartForm').setAttribute('data-product-sku', product.productSku);
                        }

                        // Cập nhật giá
                        const productPrice = document.getElementById("ProductPrice");
                        if (productPrice) {
                            productPrice.textContent = product.productPrice;
                        }

                        // Cập nhật mô tả
                        const productDescription = document.getElementById("product-long-description");
                        if (productDescription) {
                            const formattedDescription = product.productDescription
                                .split('\n\n')
                                .map(paragraph => `<p>${paragraph}</p>`)
                                .join('');
                            productDescription.innerHTML = formattedDescription;
                        }

                        // Cập nhật topping
                        const toppingsContainer = document.querySelector("#variant-swatch-0-quickview");
                        if (toppingsContainer) {
                            const selectSwap = toppingsContainer.querySelector(".select-swap");
                            if (selectSwap) {
                                selectSwap.innerHTML = "";
                                if (product.toppings && product.toppings.length > 0) {
                                    product.toppings.forEach((topping, index) => {
                                        const toppingHTML = `
                    <div data-value="${topping.value}" class="n-sd swatch-element ${topping.value}" style="position: relative;">
                        <input class="variant-0 input-quickview topping-checkbox" id="qv-swatch-0-${topping.value}" 
                            type="checkbox" name="topping" value="${topping.value}" data-topping-value="${topping.value}">
                        <label for="qv-swatch-0-${topping.value}">
                            <span class="topping-content">
                                <div class="topping-name">${topping.name}</div>
                                <div class="topping-price">${topping.price.toLocaleString('vi-VN')}₫</div>
                            </span>
                            <img class="crossed-out" src="//theme.hstatic.net/1000313040/1000406925/14/soldout.png">
                            <img class="img-check" src="//theme.hstatic.net/1000313040/1000406925/14/select-pro.png">
                        </label>
                        <div class="topping-count">1</div>
                    </div>
                `;
                                        selectSwap.innerHTML += toppingHTML;
                                    });
                                    toppingsContainer.style.display = 'block'; // Hiển thị container nếu có topping
                                } else {
                                    toppingsContainer.style.display = 'none'; // Ẩn toàn bộ container nếu không có topping
                                }
                            }
                        }

                        // Cập nhật đồ uống (extraWater)
                        const drinksContainer = document.querySelector("#variant-swatch-1-quickview");
                        if (drinksContainer) {
                            const selectSwap = drinksContainer.querySelector(".select-swap");
                            if (selectSwap) {
                                selectSwap.innerHTML = "";
                                if (product.extraWater && product.extraWater.length > 0) {
                                    product.extraWater.forEach((drink, index) => {
                                        const drinkHTML = `
                    <div data-value="${drink.name.replace(/\s+/g, '-').toLowerCase()}" class="n-sd swatch-element ${drink.name.replace(/\s+/g, '-').toLowerCase()}" style="position: relative;">
                        <input class="variant-1 input-quickview drink-checkbox" id="qv-swatch-1-${drink.name.replace(/\s+/g, '-').toLowerCase()}" 
                            type="checkbox" name="drink" value="${drink.name}" data-drink-value="${drink.name}">
                        <label for="qv-swatch-1-${drink.name.replace(/\s+/g, '-').toLowerCase()}">
                            <span class="drink-content">
                                <div class="drink-name">${drink.name}</div>
                                <div class="drink-price">${drink.price === 0 ? 'Miễn phí' : drink.price.toLocaleString('vi-VN') + '₫'}</div>
                            </span>
                            <img class="crossed-out" src="//theme.hstatic.net/1000313040/1000406925/14/soldout.png">
                            <img class="img-check" src="//theme.hstatic.net/1000313040/1000406925/14/select-pro.png">
                        </label>
                        <div class="drink-count">1</div>
                    </div>
                `;
                                        selectSwap.innerHTML += drinkHTML;
                                    });
                                    drinksContainer.style.display = 'block'; // Hiển thị container nếu có đồ uống
                                } else {
                                    console.log("Không có đồ uống");
                                    drinksContainer.style.display = 'none'; // Ẩn toàn bộ container nếu không có đồ uống
                                }
                            }
                        }
                        // Khởi tạo lại Owl Carousel cho #ProductPhoto
                        const $productPhoto = $("#ProductPhoto");
                        if ($productPhoto.data('owlCarousel')) {
                            $productPhoto.data('owlCarousel').destroy();
                        }
                        $productPhoto.owlCarousel({
                            items: 1,
                            navigation: true,
                            pagination: false,
                            slideSpeed: 300,
                            navigationText: ['<i class="fa fa-angle-left" aria-hidden="true"></i>', '<i class="fa fa-angle-right" aria-hidden="true"></i>']
                        });

                        // Khởi tạo lại elevateZoom và productImageSwitch
                        if ($(window).width() > 768) {
                            $('.zoomContainer').remove();
                            $("#ProductPhoto img").removeData('elevateZoom').removeAttr('data-zoom-image');
                            if (productImage) {
                                productImage.setAttribute("data-zoom-image", newImageSrc);
                            }
                            try {
                                $("#ProductPhoto img").elevateZoom({
                                    zoomType: "window",
                                    cursor: "crosshair",
                                    zoomWindowFadeIn: 200,
                                    zoomWindowFadeOut: 200,
                                    zoomWindowWidth: 450,
                                    zoomWindowHeight: 450,
                                    lensSize: 100,
                                    lensFadeIn: 100,
                                    lensFadeOut: 100,
                                    borderSize: 1,
                                    borderColour: "#888"
                                });
                            } catch (e) {
                                console.error("Error initializing elevateZoom:", e);
                            }
                            $('.zoomWindowContainer div').css("background-image", "url('" + newImageSrc + "')");
                            timber.productImageSwitch();
                        } else {
                            console.log("Screen width <= 768, skipping elevateZoom");
                        }
                    } else {
                        console.error('Sản phẩm không tìm thấy trong dữ liệu:', fileName);
                    }
                })
                .catch(error => console.error('Error loading product data:', error));
        });
    </script>
    <!-- // Script xử lý sự kiện cho topping và drink -->
    <script>

        jQuery(document).ready(function () {
            // Xử lý sự kiện click cho topping
            jQuery('#PageContainer').on('click', '.swatch-element label, .swatch-element .topping-content, .swatch-element .topping-name, .swatch-element .topping-price, .swatch-element img', function (e) {
                e.stopPropagation();
                if (e.target.tagName.toLowerCase() === 'input') {
                    return;
                }
                var $swatchElement = $(this).closest('.swatch-element');
                var $input = $swatchElement.find('input.input-quickview');
                if (!$input.prop('checked')) {
                    $input.prop('checked', true).trigger('change');
                } else {
                    $input.prop('checked', false).trigger('change');
                }
            });

            jQuery('#PageContainer').on('touchstart', '.swatch-element label, .swatch-element .topping-content, .swatch-element .topping-name, .swatch-element .topping-price, .swatch-element img', function (e) {
                e.stopPropagation();
                if (e.target.tagName.toLowerCase() === 'input') {
                    return;
                }
                var $swatchElement = $(this).closest('.swatch-element');
                var $input = $swatchElement.find('input.input-quickview');
                if (!$input.prop('checked')) {
                    $input.prop('checked', true).trigger('change');
                } else {
                    $input.prop('checked', false).trigger('change');
                }
            });

            jQuery('#PageContainer').on('click', 'input.topping-checkbox', function (e) {
                var $this = $(this);
                var countElement = $this.closest('.swatch-element').find('.topping-count');
                var isSelected = $this.next().hasClass('sd');

                var count;
                if (!isSelected) {
                    count = 1;
                } else {
                    count = parseInt(countElement.text()) || 0;
                    count = (count % 2) + 1;
                }

                countElement.text(count);
                if (count === 2) {
                    $this.next().removeClass('sd');
                    countElement.css('display', 'none');
                } else {
                    $this.next().addClass('sd');
                    countElement.css('display', 'block');
                }

                var name = $this.attr('name');
                var value = $this.val();
                $('#PageContainer select[data-option=' + name + ']').val(value).trigger('change');

                if ($this.data('img-src')) {
                    var img_ = $this.data('img-src');
                    $('#PageContainer .product-single__thumbnail[href="' + img_ + '"]').trigger('click');
                }

                var swatch_size = parseInt($('#PageContainer .select-swatch').children().size());
                if (swatch_size > 1) {
                    handleSwatchLogic($this, name, swatch_size);
                }
            });

            // Xử lý sự kiện click cho drink
            // Hàm tính tổng số lượng đồ uống có giá = 0
            function getTotalFreeDrinks() {
                let total = 0;
                $('.swatch-element input.input-quickview.drink-checkbox:checked').each(function () {
                    var $swatchElement = $(this).closest('.swatch-element');
                    var priceText = $swatchElement.find('.drink-price').text().trim();
                    var price = priceText === 'Miễn phí' ? 0 : parseInt(priceText.replace(/[^0-9]/g, '')) || 0;
                    if (price === 0) {
                        var count = parseInt($swatchElement.find('.drink-count').text()) || 0;
                        total += count;
                    }
                });
                return total;
            }

            // Hàm kiểm tra và điều chỉnh số lượng đồ uống miễn phí
            function adjustFreeDrinks() {
                var productQuantity = parseInt($('#Quantity').val()) || 1;
                var totalFreeDrinks = getTotalFreeDrinks();
                while (totalFreeDrinks > productQuantity) {
                    let removed = false;
                    $('.swatch-element input.input-quickview.drink-checkbox:checked').each(function () {
                        var $swatchElement = $(this).closest('.swatch-element');
                        var priceText = $swatchElement.find('.drink-price').text().trim();
                        var price = priceText === 'Miễn phí' ? 0 : parseInt(priceText.replace(/[^0-9]/g, '')) || 0;
                        if (price === 0 && totalFreeDrinks > productQuantity) {
                            $(this).prop('checked', false).trigger('change');
                            $swatchElement.find('.drink-count').text(0).css('display', 'none');
                            $(this).next().removeClass('sd');
                            totalFreeDrinks -= 1;
                            removed = true;
                        }
                    });
                    if (!removed) break;
                }

            }

            // Xử lý sự kiện click cho nút "Thêm vào giỏ"
            jQuery('#AddToCart').on('click', function (e) {
                var productQuantity = parseInt($('#Quantity').val()) || 1;
                var totalFreeDrinks = getTotalFreeDrinks();

                if (totalFreeDrinks > productQuantity) {
                    e.preventDefault();
                    alert('Số lượng đồ uống miễn phí vượt quá số lượng sản phẩm chính. Một số lựa chọn đã bị bỏ.');
                    //$('#AddToCardQuickView').hide();
                    adjustFreeDrinks();

                }
            });

            // Script xử lý sự kiện cho đồ uống
            jQuery('#variant-swatch-1-quickview').on('click', '.swatch-element label, .swatch-element .drink-content, .swatch-element .drink-name, .swatch-element .drink-price, .swatch-element img', function (e) {
                e.preventDefault();
                e.stopPropagation();

                var $swatchElement = $(this).closest('.swatch-element');
                var $input = $swatchElement.find('input.input-quickview.drink-checkbox');
                var priceText = $swatchElement.find('.drink-price').text().trim();
                var price = priceText === 'Miễn phí' ? 0 : parseInt(priceText.replace(/[^0-9]/g, '')) || 0;

                if (price === 0 && !$input.prop('checked')) {
                    var productQuantity = parseInt($('#Quantity').val()) || 1;
                    var totalFreeDrinks = getTotalFreeDrinks();
                    if (totalFreeDrinks >= productQuantity) {
                        alert('Bạn không thể chọn thêm đồ uống miễn phí, hãy đặt thêm món.');
                        return;
                    }
                }
                $input.prop('checked', !$input.prop('checked')).trigger('change');
                // Thêm dòng này để đảm bảo kích hoạt cập nhật giá
                handleOptionChange();
            });

            // Xử lý sự kiện touchstart cho các phần tử liên quan đến đồ uống
            jQuery('#variant-swatch-1-quickview').on('touchstart', '.swatch-element label, .swatch-element .drink-content, .swatch-element .drink-name, .swatch-element .drink-price, .swatch-element img', function (e) {
                e.preventDefault();
                e.stopPropagation();

                var $swatchElement = $(this).closest('.swatch-element');
                var $input = $swatchElement.find('input.input-quickview.drink-checkbox');
                var priceText = $swatchElement.find('.drink-price').text().trim();
                var price = priceText === 'Miễn phí' ? 0 : parseInt(priceText.replace(/[^0-9]/g, '')) || 0;

                if (price === 0 && !$input.prop('checked')) {
                    var productQuantity = parseInt($('#Quantity').val()) || 1;
                    var totalFreeDrinks = getTotalFreeDrinks();
                    if (totalFreeDrinks >= productQuantity) {
                        alert('Bạn không thể chọn thêm đồ uống miễn phí vì đã đạt giới hạn số lượng sản phẩm chính.');
                        return;
                    }
                }

                $input.prop('checked', !$input.prop('checked')).trigger('change');
                // Thêm dòng này để đảm bảo kích hoạt cập nhật giá
                handleOptionChange();
            });

            // Xử lý sự kiện khi input drink-checkbox thay đổi
            jQuery('#variant-swatch-1-quickview').on('change', 'input.input-quickview.drink-checkbox', function (e) {
                var $this = $(this);
                var $swatchElement = $this.closest('.swatch-element');
                var countElement = $swatchElement.find('.drink-count');
                var isChecked = $this.prop('checked');

                var count = isChecked ? 1 : 0;

                countElement.text(count);

                if (!isChecked) {
                    $this.prop('checked', false);
                    $this.next().removeClass('sd');
                    countElement.css('display', 'none');
                } else {
                    $this.prop('checked', true);
                    $this.next().addClass('sd');
                    countElement.css('display', 'block');
                }

                adjustFreeDrinks();

                var name = $this.attr('name');
                var value = $this.val();
                $('#variant-swatch-1-quickview select[data-option=' + name + ']').val(value).trigger('change');

                // Thêm dòng này để đảm bảo kích hoạt cập nhật giá
                handleOptionChange();
            });
            // Xử lý sự kiện khi số lượng sản phẩm chính thay đổi
            jQuery('#Quantity').on('input change', function () {
                var quantity = parseInt($(this).val()) || 1;
                if (quantity < 1) {
                    $(this).val(1);
                }
                adjustFreeDrinks();

            });

            // Xử lý sự kiện click cho nút tăng/giảm số lượng
            jQuery('.js-qty__adjust--plus, .js-qty__adjust--minus').on('click', function () {
                var $input = $('#Quantity');
                var currentQuantity = parseInt($input.val()) || 1;
                var isPlus = $(this).hasClass('js-qty__adjust--plus');
                var newQuantity = isPlus ? currentQuantity + 1 : currentQuantity - 1;

                if (newQuantity < 1) {
                    newQuantity = 1;
                }

                $input.val(newQuantity).trigger('change');
            });
            // Hàm khởi tạo phần tử hiển thị số lượng
            function initializeCounts() {
                $('.swatch-element').each(function () {
                    var $this = $(this);
                    if ($this.find('input.topping-checkbox').length > 0 && $this.find('.topping-count').length === 0) {
                        $this.append('<div class="topping-count" style="position: absolute; top: 0; right: 0; background: red; color: white; border-radius: 50%; width: 20px; height: 20px; text-align: center; line-height: 20px; font-size: 12px; display: none;">0</div>');
                    }
                    if ($this.find('input.drink-checkbox').length > 0 && $this.find('.drink-count').length === 0) {
                        $this.append('<div class="drink-count" style="position: absolute; top: 0; right: 0; background: red; color: white; border-radius: 50%; width: 20px; height: 20px; text-align: center; line-height: 20px; font-size: 12px; display: none;">0</div>');
                    }
                });
            }

            // Gọi hàm khởi tạo khi tài liệu sẵn sàng
            initializeCounts();

            // Hàm xử lý logic cho swatch size
            function handleSwatchLogic($this, name, swatch_size) {
                if (swatch_size == 2) {
                    if (name.indexOf('1') != -1) {
                        enableSwatchOptions(1);
                    }
                } else if (swatch_size == 3) {
                    if (name.indexOf('1') != -1) {
                        enableSwatchOptions(1);
                        enableSwatchOptions(2);
                    } else if (name.indexOf('2') != -1) {
                        enableSwatchOptions(2);
                    }
                }
            }

            // Hàm bật các tùy chọn swatch
            function enableSwatchOptions(optionIndex) {
                $('#variant-swatch-' + optionIndex + '-quickview .swatch-element').find('input').prop('disabled', false);
                $('#variant-swatch-' + optionIndex + '-quickview .swatch-element label').removeClass('sd');
                $('#variant-swatch-' + optionIndex + '-quickview .swatch-element').removeClass('soldout');
            }
        });

    </script>

    <!-- css cho topping -->
    <style>
        .topping-count {
            position: absolute;
            top: 0;
            right: 0;
            background-color: red;
            color: white;
            border-radius: 50%;
            width: 15px;
            height: 15px;
            text-align: center;
            line-height: 15px;
            font-size: 10px;
            font-weight: bold;
            display: none;
            /* Ẩn mặc định, sẽ hiển thị khi số lượng > 1 */
        }

        .topping-name {
            user-select: none;
            /* Chặn bôi đen chữ */
            -webkit-user-select: none;
            /* Cho trình duyệt WebKit (Chrome, Safari) */
            -moz-user-select: none;
            /* Cho Firefox */
            -ms-user-select: none;
            /* Cho IE/Edge */
        }

        .topping-price {
            user-select: none;
            /* Chặn bôi đen chữ */
            -webkit-user-select: none;
            /* Cho trình duyệt WebKit (Chrome, Safari) */
            -moz-user-select: none;
            /* Cho Firefox */
            -ms-user-select: none;
            /* Cho IE/Edge */
            color: #ff5722;
            font-size: 12px;
            /* Giảm kích thước font */
            font-weight: normal;
        }

        .swatch-element .sd+.topping-count {
            display: block;
            /* Hiển thị khi topping được chọn */
        }
    </style>
    <!-- CSS cho đồ uống -->
    <style>
        .drink-count {
            position: absolute;
            top: 0;
            right: 0;
            background-color: red;
            color: white;
            border-radius: 50%;
            width: 15px;
            height: 15px;
            text-align: center;
            line-height: 15px;
            font-size: 10px;
            font-weight: bold;
            display: none;
            /* Ẩn mặc định, sẽ hiển thị khi số lượng > 1 */
        }

        .drink-name {
            user-select: none;
            /* Chặn bôi đen chữ */
            -webkit-user-select: none;
            /* Cho trình duyệt WebKit (Chrome, Safari) */
            -moz-user-select: none;
            /* Cho Firefox */
            -ms-user-select: none;
            /* Cho IE/Edge */
        }

        .drink-price {
            user-select: none;
            /* Chặn bôi đen chữ */
            -webkit-user-select: none;
            /* Cho trình duyệt WebKit (Chrome, Safari) */
            -moz-user-select: none;
            /* Cho Firefox */
            -ms-user-select: none;
            /* Cho IE/Edge */
            color: #ff5722;
            font-size: 12px;
            /* Giảm kích thước font */
            font-weight: normal;
        }

        .swatch-element .sd+.drink-count {
            display: block;
            /* Hiển thị khi topping được chọn */
        }
    </style>
    <!-- cập nhật giá sản phẩm trong trang web -->
    <script>
        let priceElement = null;
        let quantityInput = null;
        let isInitialized = false;
        let productSku = '';

        let debounceTimer;
        let currentRequest = null;
        let lastRequestData = null;
        let isUpdating = false;

        // Thêm hàm khởi tạo ngay khi trang tải xong, không cần chờ click
        document.addEventListener('DOMContentLoaded', function () {
            // Khởi tạo ngay khi trang tải xong
            setTimeout(() => {
                if (!isInitialized) {
                    priceElement = document.querySelector('#PageContainer .ProductPrice');
                    quantityInput = document.querySelector('#PageContainer input[name="quantity"]');

                    const skuElement = document.querySelector('[data-product-sku]');
                    if (skuElement) {
                        productSku = skuElement.getAttribute('data-product-sku');
                    }

                    if (priceElement && quantityInput && productSku) {
                        isInitialized = true;

                        quantityInput.removeEventListener("input", handleQuantityChange);
                        quantityInput.addEventListener("input", handleQuantityChange);

                        quantityInput.removeEventListener("change", handleQuantityChange);
                        quantityInput.addEventListener("change", handleQuantityChange);

                        const minusButton = document.querySelector('.js-qty__adjust--minus');
                        const plusButton = document.querySelector('.js-qty__adjust--plus');

                        if (minusButton) {
                            minusButton.removeEventListener("click", triggerQuantityInput);
                            minusButton.addEventListener("click", triggerQuantityInput);
                        }

                        if (plusButton) {
                            plusButton.removeEventListener("click", triggerQuantityInput);
                            plusButton.addEventListener("click", triggerQuantityInput);
                        }

                        // Thiết lập sự kiện cho topping và đồ uống
                        setupEvents();
                    }
                }
            }, 500);
        });


        document.addEventListener('DOMContentLoaded', function () {
            document.addEventListener('click', function (event) {
                setTimeout(() => {
                    if (!isInitialized) {
                        priceElement = document.querySelector('#PageContainer .ProductPrice');
                        quantityInput = document.querySelector('#PageContainer input[name="quantity"]');

                        const skuElement = document.querySelector('[data-product-sku]');
                        if (skuElement) {
                            productSku = skuElement.getAttribute('data-product-sku');
                        }

                        if (priceElement && quantityInput && productSku) {
                            isInitialized = true;

                            quantityInput.removeEventListener("input", handleQuantityChange);
                            quantityInput.addEventListener("input", handleQuantityChange);

                            quantityInput.removeEventListener("change", handleQuantityChange);
                            quantityInput.addEventListener("change", handleQuantityChange);

                            const minusButton = document.querySelector('.js-qty__adjust--minus');
                            const plusButton = document.querySelector('.js-qty__adjust--plus');

                            if (minusButton) {
                                minusButton.removeEventListener("click", triggerQuantityInput);
                                minusButton.addEventListener("click", triggerQuantityInput);
                            }

                            if (plusButton) {
                                plusButton.removeEventListener("click", triggerQuantityInput);
                                plusButton.addEventListener("click", triggerQuantityInput);
                            }
                        } else {
                            console.log("Không tìm thấy phần tử giá, số lượng hoặc SKU!");
                            return;
                        }

                        jQuery('#PageContainer').off('change', 'input.input-quickview');
                        jQuery('#PageContainer').off('click', '.topping-quantity-btn');

                        // Lắng nghe sự kiện thay đổi topping và đồ uống
                        jQuery('#PageContainer').on('change', 'input.input-quickview', function (e) {
                            handleOptionChange();
                        });

                        // Lắng nghe sự kiện thay đổi số lượng topping (nếu có nút điều chỉnh)
                        jQuery('#PageContainer').on('click', '.topping-quantity-btn', function () {
                            handleOptionChange();
                        });

                        // Lắng nghe sự kiện thay đổi số lượng đồ uống (nếu có nút điều chỉnh, tùy chọn)
                        jQuery('#PageContainer').on('click', '.drink-quantity-btn', function () {
                            handleOptionChange();
                        });
                    }

                    debouncedUpdatePrice();
                }, 300);
            });
        });

        function handleQuantityChange() {
            debouncedUpdatePrice();
        }

        function handleOptionChange() {
            debouncedUpdatePrice();
        }

        function triggerQuantityInput() {
            if (quantityInput) {
                setTimeout(() => {
                    quantityInput.dispatchEvent(new Event("input"));
                }, 50);
            }
        }

        function debouncedUpdatePrice() {
            if (debounceTimer) {
                clearTimeout(debounceTimer);
            }

            if (currentRequest && currentRequest.readyState !== 4) {
                currentRequest.abort();
            }

            debounceTimer = setTimeout(() => {
                updatePriceFromServer();
            }, 150);
        }

        function updatePriceFromServer() {
            if (!priceElement || !quantityInput || !productSku) return;

            if (isUpdating) return;

            isUpdating = true;

            let quantityValue = parseInt(quantityInput.value) || 1;

            // Thu thập dữ liệu topping đã chọn
            let selectedToppings = [];
            jQuery('#PageContainer input.input-quickview.topping-checkbox').each(function () {
                let $this = jQuery(this);
                let isSelected = $this.next().hasClass('sd');

                if (isSelected) {
                    let toppingValue = $this.val();
                    let toppingCountElement = $this.closest('.swatch-element').find('.topping-count');
                    let toppingCount = parseInt(toppingCountElement.text()) || 1;

                    selectedToppings.push({
                        value: toppingValue,
                        quantity: toppingCount
                    });
                }
            });

            // Thu thập dữ liệu đồ uống đã chọn
            let selectedDrinks = [];
            jQuery('#PageContainer input.input-quickview.drink-checkbox').each(function () {
                let $this = jQuery(this);
                let isSelected = $this.next().hasClass('sd');

                if (isSelected) {
                    let drinkValue = $this.val();
                    let drinkCountElement = $this.closest('.swatch-element').find('.drink-count');
                    let drinkCount = parseInt(drinkCountElement.text()) || 1;

                    selectedDrinks.push({
                        value: drinkValue,
                        quantity: drinkCount
                    });
                }
            });

            const requestData = {
                productSku: productSku,
                quantity: quantityValue,
                toppings: JSON.stringify(selectedToppings),
                drinks: JSON.stringify(selectedDrinks)
            };

            const requestDataStr = JSON.stringify(requestData);
            if (lastRequestData === requestDataStr) {
                isUpdating = false;
                return;
            }

            lastRequestData = requestDataStr;

            const originalPrice = priceElement.textContent;
            priceElement.innerHTML = '<span style="opacity:0.7">Đang tính...</span>';

            currentRequest = jQuery.ajax({
                url: '../calculatePrice.php',
                type: 'POST',
                data: requestData,
                dataType: 'json',
                success: function (response) {
                    if (response.success) {
                        priceElement.textContent = response.totalPrice;
                    } else {
                        console.error('Lỗi khi tính giá:', response.error);
                        priceElement.textContent = originalPrice;
                    }
                },
                error: function (xhr, status, error) {
                    if (status !== 'abort') {
                        console.error('Lỗi AJAX:', error);
                        priceElement.textContent = originalPrice;
                    }
                },
                complete: function () {
                    currentRequest = null;
                    isUpdating = false;
                }
            });
        }
    </script>

    <!-- Push sản phẩm lên localSession và hiển thị trên giỏ hàng-->
    <script>
        var localCart = (function (module, $) {
            'use strict';

            // Public functions
            var init, addItem, loadCart, removeItem, updateCartDisplay, removeTopping, removeDrink;

            // Private variables
            var settings, $cartContainer, $cartCount, $cartTotal;

            /*============================================================================
              Khởi tạo giỏ hàng và thiết lập biến
            ==============================================================================*/
            init = function (options) {
                settings = {
                    cartContainer: '#CartContainer',
                    cartCount: '#CartCount',
                    cartTotal: '#CartTotal',
                    moneyFormat: '{{amount}}₫'
                };

                $.extend(settings, options);

                $cartContainer = $(settings.cartContainer);
                $cartCount = $(settings.cartCount);
                $cartTotal = $(settings.cartTotal);

                loadCart();

                $(document).on('click', '#AddToCart', function (event) {
                    event.preventDefault();
                    addItem();
                });

                $(document).on('click', '.remove-item', function () {
                    var index = $(this).data('index');
                    removeItem(index);
                });

                $(document).on('click', '.remove-topping', function () {
                    var itemIndex = $(this).data('item-index');
                    var toppingIndex = $(this).data('topping-index');
                    removeTopping(itemIndex, toppingIndex);
                });

                $(document).on('click', '.remove-drink', function () {
                    var itemIndex = $(this).data('item-index');
                    var drinkIndex = $(this).data('drink-index');
                    removeDrink(itemIndex, drinkIndex);
                });
            };

            /*============================================================================
              Thêm sản phẩm vào giỏ hàng
            ==============================================================================*/
            addItem = function () {
                let productName = $('#PageContainer h1[itemprop="name"]').text().trim();
                let productImage = $('#PageContainer #ProductPhoto img').first().attr('src');
                let productSku = $('#PageContainer #ProductSku').text().trim();
                let productPrice = extractPrice($('#PageContainer .ProductPrice').text());
                let productQuantity = parseInt($('#PageContainer input[name="quantity"]').val()) || 1;

                let selectedToppings = [];
                $('#PageContainer .swatch-element').each(function () {
                    let $this = $(this);
                    let input = $this.find('input.input-quickview.topping-checkbox');
                    if (input.length === 0) return;

                    let isSelected = input.next().hasClass('sd');
                    let toppingQuantity = parseInt($this.find('.topping-count').text()) || 0;

                    if (isSelected || (toppingQuantity > 0 && input.is(':checked'))) {
                        let toppingName = $this.find('.topping-name').text().trim() || input.val();
                        let toppingPriceElement = $this.find('.topping-price');
                        let toppingPrice = toppingPriceElement.length ? extractPrice(toppingPriceElement.text()) : 15000;
                        selectedToppings.push({
                            toppingName,
                            toppingPrice,
                            toppingQuantity
                        });
                    }
                });

                let selectedExtraWaters = [];
                $('#PageContainer .swatch-element').each(function () {
                    let $this = $(this);
                    let input = $this.find('input.input-quickview.drink-checkbox');
                    if (input.length === 0) return;

                    let isSelected = input.next().hasClass('sd');
                    let waterQuantity = parseInt($this.find('.drink-count').text()) || 0;

                    if (isSelected || (waterQuantity > 0 && input.is(':checked'))) {
                        let waterName = $this.find('.drink-name').text().trim() || input.val();
                        let waterPriceElement = $this.find('.drink-price');
                        let waterPriceText = waterPriceElement.text().trim();
                        let waterPrice = waterPriceText.includes('Miễn phí') || waterPriceText === '' ? 0 : extractPrice(waterPriceText);
                        selectedExtraWaters.push({
                            waterName,
                            waterPrice,
                            waterQuantity
                        });
                    }
                });

                let cart = JSON.parse(localStorage.getItem('cart')) || [];
                cart.push({
                    productName,
                    productImage,
                    productSku,
                    productPrice,
                    productQuantity,
                    selectedToppings,
                    selectedExtraWaters
                });

                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartDisplay();

                jQuery(document.body).trigger('afterCartLoad.ajaxCart', [cart]);
            };

            /*============================================================================
              Hiển thị giỏ hàng lên giao diện
            ==============================================================================*/
            updateCartDisplay = function () {
                let cart = JSON.parse(localStorage.getItem('cart')) || [];
                let cartHtml = '';
                let totalCost = 0;

                if (cart.length === 0) {
                    cartHtml = '<p>Giỏ hàng trống!</p>' +
                        '<p>Xem thêm những món ngon <a href="../" style="color: red; text-decoration: underline;">tại đây</a></p>';
                    $cartTotal.html(formatMoney(0));
                    $cartCount.text(0);
                } else {
                    cart.forEach((item, index) => {
                        let toppingsTotal = 0;
                        let toppingsHtml = (item.selectedToppings || []).map((topping, toppingIndex) => {
                            let toppingPrice = topping.toppingPrice || 0;
                            let toppingQuantity = topping.toppingQuantity || 0;
                            let toppingCost = toppingPrice * toppingQuantity;
                            toppingsTotal += toppingCost;
                            return `<li>
                        ${topping.toppingName || 'Unknown Topping'} (${toppingQuantity}) - ${formatMoney(toppingCost)}
                        <button class="remove-topping" data-item-index="${index}" data-topping-index="${toppingIndex}" style="color: red; margin-left: 5px; border: none; background: none; cursor: pointer;">Xóa</button>
                    </li>`;
                        }).join('');

                        let drinksTotal = 0;
                        let drinksHtml = (item.selectedExtraWaters || []).map((drink, drinkIndex) => {
                            let waterPrice = drink.waterPrice || 0;
                            let waterQuantity = drink.waterQuantity || 0;
                            let drinkCost = waterPrice * waterQuantity;
                            drinksTotal += drinkCost;
                            return `<li>
                        ${drink.waterName || 'Unknown Drink'} (${waterQuantity}) - ${formatMoney(drinkCost)}
                        <button class="remove-drink" data-item-index="${index}" data-drink-index="${drinkIndex}" style="color: red; margin-left: 5px; border: none; background: none; cursor: pointer;">Xóa</button>
                    </li>`;
                        }).join('');

                        let baseProductPrice = (item.productPrice - drinksTotal - toppingsTotal) / item.productQuantity;
                        let itemTotal = item.productPrice;
                        totalCost += item.productPrice;
                        let image = normalizeImagePath(item.productImage) || '//theme.hstatic.net/1000313040/1000406925/14/logobmc_big.png';

                        cartHtml += `
                    <div class="cart-item">
                        <img src="${image}" alt="${item.productName || 'Unknown Product'}" class="cart-img">
                        <div class="cart-info">
                            <strong>${item.productName || 'Unknown Product'}</strong> - ${formatMoney(baseProductPrice)}
                            <p>Số lượng: ${item.productQuantity || 1}</p>
                            <ul>${toppingsHtml}${drinksHtml}</ul>
                            <p><strong>Tổng: ${formatMoney(itemTotal)}</strong></p>
                            <button class="remove-item" data-index="${index}" style="color: red;">Xóa</button>
                            <p></p>
                        </div>
                    </div>
                `;
                    });

                    cartHtml += `
                <div class="cart-summary">
                    <p class="total-cost"><strong>Tổng Giá:</strong> ${formatMoney(totalCost)}</p>
                    <a href="../cart.html" class="order-button btn--secondary btn--full">Đặt hàng</a>
                </div>
            `;
                }

                $cartContainer.html(cartHtml);
                $cartTotal.html(formatMoney(totalCost));
                $cartCount.text(cart.length);
            };

            /*============================================================================
              Xóa sản phẩm khỏi giỏ hàng
            ==============================================================================*/
            removeItem = function (index) {
                let cart = JSON.parse(localStorage.getItem('cart')) || [];
                cart.splice(index, 1);
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartDisplay();
            };

            /*============================================================================
              Xóa topping khỏi sản phẩm trong giỏ hàng
            ==============================================================================*/
            removeTopping = function (itemIndex, toppingIndex) {
                let cart = JSON.parse(localStorage.getItem('cart')) || [];
                if (cart[itemIndex] && cart[itemIndex].selectedToppings) {
                    let topping = cart[itemIndex].selectedToppings[toppingIndex];
                    if (topping) {
                        let toppingCost = topping.toppingPrice * topping.toppingQuantity;
                        cart[itemIndex].productPrice -= toppingCost;
                        cart[itemIndex].selectedToppings.splice(toppingIndex, 1);
                        localStorage.setItem('cart', JSON.stringify(cart));
                        updateCartDisplay();
                    }
                }
            };

            /*============================================================================
              Xóa đồ uống khỏi sản phẩm trong giỏ hàng
            ==============================================================================*/
            removeDrink = function (itemIndex, drinkIndex) {
                let cart = JSON.parse(localStorage.getItem('cart')) || [];
                if (cart[itemIndex] && cart[itemIndex].selectedExtraWaters) {
                    let drink = cart[itemIndex].selectedExtraWaters[drinkIndex];
                    if (drink) {
                        let drinkCost = drink.waterPrice * drink.waterQuantity;
                        cart[itemIndex].productPrice -= drinkCost;
                        cart[itemIndex].selectedExtraWaters.splice(drinkIndex, 1);
                        localStorage.setItem('cart', JSON.stringify(cart));
                        updateCartDisplay();
                    }
                }
            };

            /*============================================================================
              Load giỏ hàng khi trang tải lại
            ==============================================================================*/
            loadCart = function () {
                updateCartDisplay();
            };

            /*============================================================================
              Hàm hỗ trợ định dạng tiền tệ
            ==============================================================================*/
            function extractPrice(priceString) {
                if (!priceString || typeof priceString !== 'string') return 0;
                const price = parseInt(priceString.replace(/[^0-9]/g, ""), 10);
                return isNaN(price) ? 0 : price;
            }

            function formatMoney(amount) {
                if (amount == null || isNaN(amount)) {
                    console.warn('Invalid amount in formatMoney:', amount);
                    return '0₫';
                }
                return amount.toLocaleString() + '₫';
            }

            function normalizeImagePath(path) {
                if (!path) return '';
                if (path.startsWith('../')) {
                    return path;
                } else if (path.startsWith('./')) {
                    return '../' + path.substring(2);
                } else {
                    return '../' + path;
                }
            }

            /*============================================================================
              Xuất module
            ==============================================================================*/
            module = {
                init: init,
                removeDrink: removeDrink
            };

            return module;
        }(localCart || {}, jQuery));

        jQuery(function ($) {
            localCart.init();
        });
    </script>


    <footer>
        <div class="footer-top">
            <div class="footer-top-overlay"></div>
            <div class="wrapper">
                <div class="inner">
                    <div class="grid-uniform">
                        <div class="grid__item large--three-twelfths medium--one-half small--one-whole">
                            <div class="ft-contact">

                                <div class="ft-contact-logo text-center">
                                    <a href="../index.html"><img
                                            src="../../theme.hstatic.net/1000313040/1000406925/14/logo_ftee64.png"
                                            alt="Bánh Mì Chảo Thương Nhớ"></a>
                                </div>

                                <div class="ft-contact-address">
                                    <i class="fa fa-home" aria-hidden="true"></i> Số 100 Phạm Huy Thông, P. Ngọc Khánh,
                                    Q.
                                    Ba Đình, TP. Hà Nội
                                </div>
                                <div class="ft-contact-tel">
                                    <i class="fa fa-mobile" aria-hidden="true"></i> <a
                                        href="tel:0931387046">0931387046</a>
                                </div>
                                <div class="ft-contact-email">
                                    <i class="fa fa-envelope" aria-hidden="true"></i> <a
                                        href="mailto:banhmichaothuongnho@gmail.com">banhmichaothuongnho@gmail.com</a>
                                </div>
                            </div>
                        </div>

                        <div class="grid__item large--three-twelfths medium--one-half small--one-whole">
                            <div class="ft-menu">
                                <h4>Chính sách</h4>
                                <ul class="no-bullets">


                                    <li><a href="./../pages/chinh-sach-va-quy-dinh-chung.html">Chính sách và quy định
                                            chung</a></li>

                                    <li><a href="./../pages/chinh-sach-giao-dich-thanh-toan.html">Chính sách giao dịch,
                                            thanh toán</a></li>

                                    <li><a href="./../pages/chinh-sach-doi-tra.html">Chính sách đổi trả</a></li>

                                    <li><a href="./../pages/chinh-sach-bao-mat.html">Chính sách bảo mật</a></li>

                                    <li><a href="./../pages/chinh-sach-van-chuyen.html">Chính sách vận chuyển</a></li>

                                </ul>
                            </div>
                        </div>

                        <div class="grid__item large--three-twelfths medium--one-half small--one-whole">
                            <div class="ft-subscribe-wrapper">
                                <h4>Bánh Mì Chảo Thương Nhớ</h4>
                                <div class="ft-subscribe">
                                    <div id="company-info"></div>

                                    <form accept-charset="UTF-8" action="./../pages/he-thong-cua-hang.html"
                                        class="contact-form" method="post" name="myForm" onsubmit="validateForm()">
                                        <input name="form_type" type="hidden" value="customer">
                                        <input name="utf8" type="hidden" value="✓">



                                        <div class="input-group">
                                            <input type="email" required value="" placeholder="Nhập email của bạn..."
                                                name="contact[email]" id="Email" class="input-group-field"
                                                aria-label="email@example.com">
                                            <input type="hidden" name="contact[tags]" value="newsletter">
                                            <span class="input-group-btn">
                                                <button type="submit" name="subscribe" id="subscribe" value="GỬI"><i
                                                        class="fa fa-paper-plane" aria-hidden="true"></i></button>
                                            </span>
                                        </div>

                                    </form>

                                </div>
                            </div>
                            <div class="ft-social-network">

                                <a href="https://www.facebook.com/profile.php?id=100067891252186" target="_blank"><i
                                        class="fa fa-facebook" aria-hidden="true"></i></a>



                                <a href="https://www.facebook.com/profile.php?id=100067891252186" target="_blank"><i
                                        class="fa fa-instagram" aria-hidden="true"></i></a>


                                <a href="#" target="_blank"><i class="fa fa-google-plus" aria-hidden="true"></i></a>


                                <a href="https://www.youtube.com/" target="_blank"><i class="fa fa-youtube"
                                        aria-hidden="true"></i></a>

                            </div>
                        </div>

                        <div class="grid__item large--three-twelfths medium--one-half small--one-whole">
                            <h4>Mỗi tháng chúng tôi đều có những đợt giảm giá dịch vụ và sản phẩm nhằm tri ân khách
                                hàng. Để có thể cập nhật kịp thời những đợt giảm giá này, vui lòng nhập địa chỉ email
                                của bạn vào ô dưới đây</h4>
                            <div id="owl-home-main-banners-slider-ft" class="owl-carousel owl-theme">
                                <!-- hình ảnh đã thông báo bộ công thương -->
                                <div class="item">
                                    <div class="ft-img">
                                        <a href="../../theme.hstatic.net/1000313040/1000406925/14/hg_img1ee64.png"
                                            data-fancybox="home-gallery-images" data-caption=""><img
                                                src="../../theme.hstatic.net/1000313040/1000406925/14/hg_img_thumb1ee64.png"
                                                alt="" /></a>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="wrapper">
                <div class="inner">
                    <div class="grid">
                        <div class="grid__item large--six-twelfths medium--one-whole small--one-whole pull-right">
                            <div class="ft-copyright-menu text-right">
                                <ul class="no-bullets">


                                </ul>
                            </div>
                        </div>
                        <div class="grid__item large--six-twelfths medium--one-whole small--one-whole">
                            <div class="ft-copyright">
                                Copyrights © 2018 by <a target="_blank" href="../index.html">Bánh Mì
                                    Chảo Thương Nhớ</a>.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <div id="back-to-top" class="text-center medium--hide small--hide">
        <i class="fa fa-angle-up" aria-hidden="true"></i>
    </div>


    <script src='../../hstatic.net/0/0/global/api.jquery.js' type='text/javascript'></script>

    <script src='../../hstatic.net/0/0/global/option_selection.js' type='text/javascript'></script>

    <script src='../../theme.hstatic.net/1000313040/1000406925/14/fastclick.minee64.js' type='text/javascript'></script>
    <script src='../../theme.hstatic.net/1000313040/1000406925/14/suplo-fnee64.js' type='text/javascript'></script>
    <script src='../../theme.hstatic.net/1000313040/1000406925/14/scriptee64.js' type='text/javascript'></script>
    <script src='../../theme.hstatic.net/1000313040/1000406925/14/timberee64.js' type='text/javascript'></script>

    <link rel="stylesheet" href="../../cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.20/jquery.fancybox.min.css" />
    <script src="../../cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.20/jquery.fancybox.min.js"></script>

    <script src='../../theme.hstatic.net/1000313040/1000406925/14/handlebars.minee64.js'
        type='text/javascript'></script>
    <!-- /snippets/ajax-cart-template.liquid -->

    <script id="AjaxQty" type="text/template">

	<div class="ajaxcart__qty">
		<button type="button" class="ajaxcart__qty-adjust ajaxcart__qty--minus icon-fallback-text" data-id="{{key}}" data-qty="{{itemMinus}}">
			<span class="icon icon-minus" aria-hidden="true"></span>
			<span class="fallback-text" aria-hidden="true">&minus;</span>
			<span class="visually-hidden">Giảm số lượng sản phẩm đi 1</span>
		</button>
		<input type="text" class="ajaxcart__qty-num" value="{{itemQty}}" min="0" data-id="{{key}}" aria-label="quantity" pattern="[0-9]*">
		<button type="button" class="ajaxcart__qty-adjust ajaxcart__qty--plus icon-fallback-text" data-id="{{key}}" data-qty="{{itemAdd}}">
			<span class="icon icon-plus" aria-hidden="true"></span>
			<span class="fallback-text" aria-hidden="true">+</span>
			<span class="visually-hidden">Tăng số lượng sản phẩm lên 1</span>
		</button>
	</div>
	
</script>
    <script id="JsQty" type="text/template">

	<div class="js-qty">
		<button type="button" class="js-qty__adjust js-qty__adjust--minus icon-fallback-text" data-id="{{key}}" data-qty="{{itemMinus}}">
			<span class="icon icon-minus" aria-hidden="true"></span>
			<span class="fallback-text" aria-hidden="true">&minus;</span>
			<span class="visually-hidden">Giảm số lượng sản phẩm đi 1</span>
		</button>
		<input type="text" class="js-qty__num" value="{{itemQty}}" min="1" data-id="{{key}}" aria-label="quantity" pattern="[0-9]*" name="{{inputName}}" id="{{inputId}}">
		<button type="button" class="js-qty__adjust js-qty__adjust--plus icon-fallback-text" data-id="{{key}}" data-qty="{{itemAdd}}">
			<span class="icon icon-plus" aria-hidden="true"></span>
			<span class="fallback-text" aria-hidden="true">+</span>
			<span class="visually-hidden">Tăng số lượng sản phẩm lên 1</span>
		</button>
	</div>
	
</script>

    <script src='../../theme.hstatic.net/1000313040/1000406925/14/ajax-cartee64.js' type='text/javascript'></script>

    <script>
        jQuery(function ($) {
            ajaxCart.init({
                formSelector: '#AddToCartForm',
                cartContainer: '#CartContainer',
                addToCartSelector: '#AddToCart',
                cartCountSelector: '#CartCount',
                cartCostSelector: '#CartCost',
                moneyFormat: "{{amount}}₫"
            });
        });

        jQuery(document.body).on('afterCartLoad.ajaxCart', function (evt, cart) {
            // Bind to 'afterCartLoad.ajaxCart' to run any javascript after the cart has loaded in the DOM
            timber.RightDrawer.open();
        });
    </script>


    <style>
        .total-cost {
            color: rgb(51, 255, 0);
            font-weight: bold;
            font-size: 18px;
        }
    </style>
    <!-- Validate quantity form & trigger zoom -->
    <script>
        $("document").ready(function () {

            $(".checkout_btn_2").on("click", function () {
                alert('a');
                event.preventDefault();
                var checked = $('textarea#CartSpecialInstructions').val();
                if (checked == '') {
                    alert('Bạn chưa điền thông tin vào chú thích cho chủ cửa hàng !');
                } else {
                    window.location = '../cart.html';
                }

            });


            $(function () {
                $(".js-qty__num").keypress(function (event) {
                    if (event.which != 8 && event.which != 0 && (event.which < 48 || event.which > 57)) {
                        return false;
                    }
                });
            });
            if ($(window).width() > 768) {
                setTimeout(function () {
                    $("#ProductThumbs .thumbnail-item:first-child a").trigger('click');
                }, 10);
            };
        });
    </script>

    <script>
        $(document).ready(function () {
            $().fancybox({
                thumbs: true,
                hash: false,
                loop: true,
            });
        });
    </script>

    <!-- Main slider video bg -->

    <script>
        jQuery(document).ready(function () {


            document.addEventListener('DOMContentLoaded', function () {
                // Tìm form chứa input email
                const form = document.querySelector('form.contact-form');

                if (form) {
                    form.addEventListener('submit', function (event) {
                        // Ngăn form gửi đi ngay lập tức
                        event.preventDefault();

                        // Lấy giá trị email và loại bỏ khoảng trắng
                        const emailInput = document.getElementById('Email');
                        const email = emailInput.value.trim();

                        // Biểu thức chính quy đơn giản để kiểm tra email
                        const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

                        if (email === '') {
                            alert('Vui lòng nhập địa chỉ email.');
                            emailInput.focus();
                            return;
                        }

                        if (!emailRegex.test(email)) {
                            alert('Địa chỉ email không hợp lệ. Vui lòng kiểm tra lại.');
                            emailInput.focus();
                            return;
                        }

                        // Nếu email hợp lệ, tiếp tục gửi form
                        form.submit();
                    });
                }
            });


            var offset = 220;
            var duration = 500;
            jQuery(window).scroll(function () {
                if (jQuery(this).scrollTop() > offset) {
                    jQuery('#back-to-top').fadeIn(duration);
                } else {
                    jQuery('#back-to-top').fadeOut(duration);
                }
            });

            jQuery('#back-to-top').click(function (event) {
                event.preventDefault();
                jQuery('html, body').animate({
                    scrollTop: 0
                }, duration);
                return false;
            })
        });

        window.onscroll = changePos;

        function changePos() {
            var header = $("#header");
            var headerheight = $("#header").height();
            if (window.pageYOffset > headerheight) {
                header.addClass('sticky-header');
            } else {
                header.removeClass('sticky-header');
            }
        }

    </script>

    <script>
        $(document).ready(function () {
            var acc = document.getElementsByClassName("accordion");
            var i;

            for (i = 0; i < acc.length; i++) {
                acc[i].onclick = function () {
                    this.classList.toggle("active");
                    var panel = this.nextElementSibling;
                    if (panel.style.maxHeight) {
                        panel.style.maxHeight = null;
                    } else {
                        panel.style.maxHeight = panel.scrollHeight + "px";
                    }
                }
            }
            if ($(window).width() > 769) {
                $('.accordion').trigger('click');
            }
        });
    </script>


    <script>
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        // Get the element with id="defaultOpen" and click on it
        //document.getElementById("defaultOpen").click();
    </script>

    <!---------------quick view --------------->

    <style>
        .modal {
            display: none;
            position: fixed;
            z-index: 99999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.4);
            transtion: all .5s;
        }

        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 780px;
            transform: translatey(-30px);
            transition: all .5s;
        }

        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            position: absolute;
            right: 0;
            top: 0;
            width: 40px;
            text-align: center;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    </style>

    <script>
        $(document).ready(function () {
            $("#home-main-slider").owlCarousel({
                items: 1,
                itemsDesktop: [1000, 1],
                itemsDesktopSmall: [900, 1],
                itemsTablet: [600, 1],
                itemsMobile: false,
                navigation: false,
                pagination: true,
                slideSpeed: 300,
                autoPlay: true,
                paginationSpeed: 400,
                navigationText: ['<i class="fa fa-angle-left" aria-hidden="true"></i>', '<i class="fa fa-angle-right" aria-hidden="true"></i>']
            });
            $("#home-main-slidermb").owlCarousel({
                items: 1,
                itemsDesktop: [1000, 1],
                itemsDesktopSmall: [900, 1],
                itemsTablet: [600, 1],
                itemsMobile: false,
                navigation: false,
                pagination: true,
                slideSpeed: 300,
                autoPlay: true,
                paginationSpeed: 400,
                navigationText: ['<i class="fa fa-angle-left" aria-hidden="true"></i>', '<i class="fa fa-angle-right" aria-hidden="true"></i>']
            });
            $(".owl-home-main-banners-slider-pd").owlCarousel({
                items: 4,
                itemsDesktop: [1000, 4],
                itemsDesktopSmall: [900, 2],
                itemsTablet: [600, 2],
                itemsMobile: false,
                navigation: false,
                pagination: false,
                slideSpeed: 300,
                paginationSpeed: 400,
                autoPlay: 5000,
                navigationText: ['<i class="fa fa-angle-left" aria-hidden="true"></i>', '<i class="fa fa-angle-right" aria-hidden="true"></i>']
            });
            $("#related-products-slider").owlCarousel({
                items: 4,
                itemsDesktop: [1000, 4],
                itemsDesktopSmall: [900, 4],
                itemsTablet: [768, 4],
                itemsMobile: [480, 2],
                navigation: true,
                pagination: false,
                slideSpeed: 300,
                paginationSpeed: 400,
                navigationText: ['<i class="fa fa-angle-left" aria-hidden="true"></i>', '<i class="fa fa-angle-right" aria-hidden="true"></i>']
            });
            $("#owl-home-main-banners-slider-art").owlCarousel({
                items: 3,
                itemsDesktop: [1000, 3],
                itemsDesktopSmall: [900, 3],
                itemsTablet: [768, 2],
                itemsMobile: [480, 1],
                navigation: true,
                pagination: false,
                slideSpeed: 300,
                paginationSpeed: 400,
                autoPlay: 5000,
                navigationText: ['<i class="fa fa-angle-left" aria-hidden="true"></i>', '<i class="fa fa-angle-right" aria-hidden="true"></i>']
            });

            $("#owl-home-main-banners-slider-ft").owlCarousel({
                items: 1,
                itemsDesktop: [1000, 1],
                itemsDesktopSmall: [900, 1],
                itemsTablet: [600, 1],
                itemsMobile: false,
                navigation: false,
                pagination: true,
                slideSpeed: 300,
                paginationSpeed: 400,
                autoPlay: 5000,
                navigationText: ['<i class="fa fa-angle-left" aria-hidden="true"></i>', '<i class="fa fa-angle-right" aria-hidden="true"></i>']
            });
        });
    </script>

    <!-- Load Facebook SDK for JavaScript -->
    <style>
        /* CSS cho nút hỗ trợ chính */
        .support-button {
            position: fixed;
            bottom: 40px;
            right: 20px;
            z-index: 999999999;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            background-color: #0f75bc;
            border-radius: 50%;
            color: white;
            cursor: move;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .support-button:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .support-button i {
            font-size: 24px;
        }

        /* Hiệu ứng pulse */
        .support-button::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background-color: #0f75bc;
            opacity: 0.7;
            animation: pulse 1.5s infinite;
            z-index: -1;
        }

        @-webkit-keyframes pulse {
            0% {
                -webkit-transform: scale(0.9);
                -moz-transform: scale(0.9);
                -ms-transform: scale(0.9);
                transform: scale(0.9);
            }

            70% {
                -webkit-transform: scale(1);
                -moz-transform: scale(1);
                -ms-transform: scale(1);
                transform: scale(1);
                box-shadow: 0 0 0 50px rgba(15, 117, 188, 0);
            }

            100% {
                -webkit-transform: scale(0.9);
                -moz-transform: scale(0.9);
                -ms-transform: scale(0.9);
                transform: scale(0.9);
                box-shadow: 0 0 0 0 rgba(15, 117, 188, 0);
            }
        }

        /* Menu tùy chọn - với background mờ và chiều rộng động */
        .support-options {
            position: absolute;
            bottom: 75px;
            right: 0;
            display: none;
            flex-direction: column;
            gap: 15px;
            width: 100px;
            /* Chỉ đủ rộng cho icon ban đầu */
            background-color: rgba(255, 255, 255, 0.5);
            /* Background mờ 50% */
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            padding: 15px;
            transition: all 0.3s ease;
            overflow: visible;
            /* Cho phép con bên trong vượt ra ngoài */
        }

        .support-options.visible {
            display: flex;
        }

        /* Tùy chọn với hiệu ứng hover mở rộng - áp dụng cho cả Messenger, Hotline và Zalo */
        .expandable-option {
            position: relative;
            display: flex;
            align-items: center;
            width: 60px;
            border-radius: 50%;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
            transition: all .3s;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.9);
            height: 60px;
            margin-left: auto;
            margin-right: auto;
            overflow: hidden;
            z-index: 1;
        }

        .expandable-option .icon-container {
            display: inline-block;
            text-align: center;
            width: 60px;
            font-size: 24px;
            line-height: 60px;
            border-radius: 50%;
            box-shadow: 0 0 0 0 rgba(15, 117, 188, 0.3);
            -webkit-animation: pulse 1.5s infinite;
            transition: all .3s;
            z-index: 2;
        }

        /* Màu cho icon Messenger */
        .expandable-option.messenger-option .icon-container {
            background: #0084FF;
            color: #ffffff;
        }

        /* Màu cho icon Hotline */
        .expandable-option.hotline-option .icon-container {
            background: #0f75bc;
            color: #ffffff;
        }

        /* Màu cho icon Zalo */
        .expandable-option.zalo-option .icon-container {
            background: #0068ff;
            color: #ffffff;
        }

        .expandable-option .text-container {
            display: inline-block;
            width: 0px;
            height: 60px;
            transition: all .3s;
            overflow: hidden;
            text-align: center;
            z-index: 1;
        }

        .expandable-option .text-container span {
            display: block;
            margin: auto;
            line-height: 60px;
            font-size: 16px;
            width: 100%;
            font-weight: bold;
            color: #2c394c;
        }

        /* Mở rộng khi hover */
        .expandable-option:hover {
            width: 200px;
            border-radius: 40px;
        }

        /* Thay đổi container cha khi con hover */
        .expandable-option:hover~.expandable-option,
        .expandable-option:hover {
            z-index: 10;
        }

        /* Mở rộng container cha khi các con hover */
        .support-options:has(.expandable-option:hover) {
            width: 210px;
            /* Đủ rộng cho phần mở rộng */
            background-color: rgba(255, 255, 255, 0.5);
            /* Giữ nguyên độ mờ */
        }

        .expandable-option:hover .icon-container {
            -webkit-animation: none;
            border-radius: 4px;
        }

        .expandable-option:hover .text-container {
            width: calc(100% - 60px);
        }

        .expandable-option.messenger-option:hover .text-container span {
            color: #0084FF;
        }

        .expandable-option.hotline-option:hover .text-container span {
            color: #0f75bc;
        }

        .expandable-option.zalo-option:hover .text-container span {
            color: #0068ff;
        }
    </style>

    <div id="supportButton" class="support-button">
        <i class="fa fa-comments"></i>

        <div class="support-options" id="supportOptions">
            <!-- Messenger với hiệu ứng hover mở rộng -->
            <div class="expandable-option messenger-option" id="messengerOption">
                <div class="icon-container">
                    <img src="https://cdn-icons-png.flaticon.com/512/5968/5968771.png" alt="Messenger" width="60"
                        height="60">
                </div>
                <div class="text-container">
                    <span>Chat Messenger</span>
                </div>
            </div>

            <!-- Zalo với hiệu ứng hover mở rộng -->
            <div class="expandable-option zalo-option" id="zaloOption">
                <div class="icon-container">
                    <img src="https://stc-zaloprofile.zdn.vn/pc/v1/images/zalo_sharelogo.png" alt="Zalo" width="60"
                        height="60" style="margin-top: 12px;">
                </div>
                <div class="text-container">
                    <span>Chat Zalo</span>
                </div>
            </div>


            <!-- Hotline với hiệu ứng hover mở rộng -->
            <div class="expandable-option hotline-option" id="hotlineOption">
                <div class="icon-container">
                    <i class="fa fa-phone"></i>
                </div>
                <div class="text-container">
                    <span>093 1387 046</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Lấy các phần tử DOM
            const supportButton = document.getElementById('supportButton');
            const supportOptions = document.getElementById('supportOptions');
            const messengerOption = document.getElementById('messengerOption');
            const zaloOption = document.getElementById('zaloOption');
            const hotlineOption = document.getElementById('hotlineOption');

            // Biến để theo dõi trạng thái
            let isMenuOpen = false;
            let isDragging = false;
            let wasDragging = false;
            let initialX, initialY;
            let offsetX = 0, offsetY = 0;
            let startTime = 0;

            // Lấy vị trí đã lưu từ localStorage
            const savedKey = 'supportButtonPosition';
            const savedPosition = localStorage.getItem(savedKey);

            // Nếu có vị trí đã lưu, áp dụng nó
            if (savedPosition) {
                try {
                    const position = JSON.parse(savedPosition);
                    supportButton.style.left = position.x + 'px';
                    supportButton.style.top = position.y + 'px';
                    supportButton.style.right = 'auto';
                    supportButton.style.bottom = 'auto';
                } catch (e) {
                    console.error('Error parsing saved position', e);
                }
            }

            // Xử lý sự kiện click cho nút hỗ trợ
            supportButton.addEventListener('click', function (e) {
                // Nếu không kéo thả, mở hoặc đóng menu
                if (!wasDragging) {
                    isMenuOpen = !isMenuOpen;
                    if (isMenuOpen) {
                        supportOptions.classList.add('visible');
                    } else {
                        supportOptions.classList.remove('visible');
                    }
                }
            });

            // Xử lý sự kiện click cho tùy chọn Messenger
            messengerOption.addEventListener('click', function (e) {
                e.stopPropagation(); // Ngăn chặn sự kiện lan ra ngoài
                window.open('https://m.me/112531760938142', '_blank');
                // Đóng menu sau khi chọn
                isMenuOpen = false;
                supportOptions.classList.remove('visible');
            });

            // Xử lý sự kiện click cho tùy chọn Zalo
            zaloOption.addEventListener('click', function (e) {
                e.stopPropagation(); // Ngăn chặn sự kiện lan ra ngoài
                window.open('https://zalo.me/0931387046', '_blank');
                // Đóng menu sau khi chọn
                isMenuOpen = false;
                supportOptions.classList.remove('visible');
            });

            // Xử lý sự kiện click cho tùy chọn Hotline
            hotlineOption.addEventListener('click', function (e) {
                e.stopPropagation(); // Ngăn chặn sự kiện lan ra ngoài
                window.location.href = 'tel:0931387046';
                // Đóng menu sau khi chọn
                isMenuOpen = false;
                supportOptions.classList.remove('visible');
            });

            // Đóng menu khi click ra ngoài
            document.addEventListener('click', function (e) {
                if (isMenuOpen && !supportButton.contains(e.target)) {
                    isMenuOpen = false;
                    supportOptions.classList.remove('visible');
                }
            });

            // Chức năng kéo thả
            supportButton.addEventListener('mousedown', dragStart);
            supportButton.addEventListener('touchstart', dragStart);

            function dragStart(e) {
                // Lưu thời gian bắt đầu để phân biệt giữa click và drag
                startTime = new Date().getTime();

                isDragging = true;
                wasDragging = false;

                // Lấy vị trí ban đầu
                initialX = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
                initialY = e.type === 'touchstart' ? e.touches[0].clientY : e.clientY;

                // Lấy vị trí hiện tại của phần tử
                const rect = supportButton.getBoundingClientRect();
                offsetX = initialX - rect.left;
                offsetY = initialY - rect.top;

                // Thêm sự kiện di chuyển và kết thúc
                document.addEventListener('mousemove', dragMove);
                document.addEventListener('touchmove', dragMove, { passive: false });
                document.addEventListener('mouseup', dragEnd);
                document.addEventListener('touchend', dragEnd);
            }

            function dragMove(e) {
                if (!isDragging) return;

                // Nếu đã di chuyển, đánh dấu là đang kéo thả
                wasDragging = true;

                // Đóng menu khi kéo
                if (isMenuOpen) {
                    isMenuOpen = false;
                    supportOptions.classList.remove('visible');
                }

                // Ngăn chặn các hành động cuộn trang mặc định khi kéo
                if (e.type === 'touchmove') {
                    e.preventDefault();
                }

                // Tính toán vị trí mới
                let clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
                let clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;

                // Cập nhật vị trí
                supportButton.style.right = 'auto';
                supportButton.style.bottom = 'auto';
                supportButton.style.left = (clientX - offsetX) + 'px';
                supportButton.style.top = (clientY - offsetY) + 'px';
            }

            function dragEnd(e) {
                if (!isDragging) return;

                // Tính thời gian đã trôi qua
                const endTime = new Date().getTime();
                const timeDiff = endTime - startTime;

                // Nếu đây là kéo thả (không phải click)
                if (wasDragging) {
                    // Lưu vị trí mới
                    const rect = supportButton.getBoundingClientRect();
                    const position = {
                        x: rect.left,
                        y: rect.top
                    };
                    localStorage.setItem(savedKey, JSON.stringify(position));
                }

                // Reset trạng thái
                isDragging = false;

                // Sau một khoảng thời gian ngắn, reset wasDragging
                // Điều này cho phép click hoạt động sau khi kéo thả
                setTimeout(() => {
                    wasDragging = false;
                }, 10);

                // Xóa các sự kiện
                document.removeEventListener('mousemove', dragMove);
                document.removeEventListener('touchmove', dragMove);
                document.removeEventListener('mouseup', dragEnd);
                document.removeEventListener('touchend', dragEnd);
            }
        });
    </script>

</body>

</html>